# –ü–ª–∞–Ω —Ä–∞–±–æ—Ç: Sales Analytics (–ê–Ω–∞–ª–∏—Ç–∏–∫–∞ –ø—Ä–æ–¥–∞–∂)

**–î–∞—Ç–∞:** 07.12.2025
**–ü—Ä–æ–µ–∫—Ç:** standalone-spark
**–û—Å–Ω–æ–≤–∞:** Excel –º–∞–∫—Ä–æ—Å—ã —Å –ª–æ–≥–∏–∫–æ–π —Ä–∞—Å—á–µ—Ç–æ–≤

---

## üìã –ò—Å—Ç–æ—á–Ω–∏–∫–∏ –¥–∞–Ω–Ω—ã—Ö (–∏–∑ Excel –º–∞–∫—Ä–æ—Å–æ–≤)

### 1. –ú–∞—Å—Ç–µ—Ä-—Ç–∞–±–ª–∏—Ü–∞ —Ç–æ–≤–∞—Ä–æ–≤
‚úÖ **–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ —á–µ—Ä–µ–∑:**
- –¢–∞–±–ª–∏—Ü–∞ `suppliers` (–ü–æ—Å—Ç–∞–≤—â–∏–∫–∏)
- –¢–∞–±–ª–∏—Ü–∞ `product_business_data` (–ù–æ–º–µ–Ω–∫–ª–∞—Ç—É—Ä–∞)

**–ü–æ–ª—è:**
- –ê—Ä—Ç–∏–∫—É–ª (offer_id) - –µ—Å—Ç—å
- –û—Å–Ω–æ–≤–Ω–æ–π –ø–æ—Å—Ç–∞–≤—â–∏–∫ - –µ—Å—Ç—å (supplier_id)
- –ù–æ–º–µ–Ω–∫–ª–∞—Ç—É—Ä–∞ - –µ—Å—Ç—å (–≤ products)
- ‚ö†Ô∏è **–í–∏–¥ –Ω–æ–º–µ–Ω–∫–ª–∞—Ç—É—Ä—ã** - `product_type` (–Ω—É–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –∑–∞–≥—Ä—É–∑–∫—É)
- ‚ö†Ô∏è **–ü–æ–¥–≤–∏–¥ –Ω–æ–º–µ–Ω–∫–ª–∞—Ç—É—Ä—ã** - `product_subtype` (–Ω—É–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –∑–∞–≥—Ä—É–∑–∫—É)
- –ö–∞—Ç–µ–≥–æ—Ä–∏—è —Ç–æ–≤–∞—Ä–∞ - –µ—Å—Ç—å
- –ó–∞–∫—É–ø–æ—á–Ω–∞—è —Ü–µ–Ω–∞ - –µ—Å—Ç—å (purchase_price)

### 2. –û—Ç—á–µ—Ç –ø–æ —Ç–æ–≤–∞—Ä–∞–º (–Ω–∞—á–∏—Å–ª–µ–Ω–∏—è –û–ó–û–ù)
‚úÖ **–¢–∞–±–ª–∏—Ü–∞:** `ozon_accruals`

**–ü–æ–ª—è:**
- –¢–∏–ø –Ω–∞—á–∏—Å–ª–µ–Ω–∏—è (accrual_type)
- –ê—Ä—Ç–∏–∫—É–ª (offer_id), SKU
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ (quantity)
- –ó–∞ –ø—Ä–æ–¥–∞–∂—É –¥–æ –≤—ã—á–µ—Ç–∞ –∫–æ–º–∏—Å—Å–∏–π (amount_before_commission)
- –ò—Ç–æ–≥–æ (total_amount)

### 3. –°—Ç–æ–∏–º–æ—Å—Ç—å —Ä–∞–∑–º–µ—â–µ–Ω–∏—è
‚úÖ **–¢–∞–±–ª–∏—Ü–∞:** `storage_costs`

**–ü–æ–ª—è:**
- –î–∞—Ç–∞ (cost_date)
- –ê—Ä—Ç–∏–∫—É–ª, SKU
- –ù–∞—á–∏—Å–ª–µ–Ω–Ω–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å —Ä–∞–∑–º–µ—â–µ–Ω–∏—è (storage_cost)
- –ö–æ–ª-–≤–æ —ç–∫–∑–µ–º–ø–ª—è—Ä–æ–≤/–æ—Å—Ç–∞—Ç–æ–∫ (stock_quantity)

### 4. –ó–∞—Ç—Ä–∞—Ç—ã –Ω–∞ –ø—Ä–æ–¥–≤–∏–∂–µ–Ω–∏–µ
‚úÖ **–¢–∞–±–ª–∏—Ü–∞:** `promotion_costs`

**–ü–æ–ª—è:**
- –ü–µ—Ä–∏–æ–¥ (period_start, period_end)
- SKU, –¢–∏–ø –ø—Ä–æ–¥–≤–∏–∂–µ–Ω–∏—è (promotion_type)
- –†–∞—Å—Ö–æ–¥ ‚ÇΩ —Å –ù–î–° (promotion_cost)

### 5. –ö–æ–Ω—Ç—Ä–æ–ª—å –æ–±—ä–µ–º–Ω—ã—Ö —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫ (–ª–∏—Ç—Ä–∞–∂)
‚úÖ **–¢–∞–±–ª–∏—Ü—ã:**
- `product_volume_standards` - —ç—Ç–∞–ª–æ–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è
- `product_volume_history` - –∏—Å—Ç–æ—Ä–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π

---

## üßÆ –§–æ—Ä–º—É–ª—ã —Ä–∞—Å—á–µ—Ç–æ–≤ (–∏–∑ Excel –º–∞–∫—Ä–æ—Å–æ–≤)

### –ò—Ç–æ–≥–æ–≤—ã–π –ª–∏—Å—Ç "–ü—Ä–æ–¥–∞–∂–∏" - –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏ –∑–∞ 2 –ø–µ—Ä–∏–æ–¥–∞:

1. **–ü—Ä–æ–¥–∞–∂–∏ (—Ä—É–±/—à—Ç)**
   ```
   = SUM(ozon_accruals WHERE accrual_type IN ('–î–æ—Å—Ç–∞–≤–∫–∞ –ø–æ–∫—É–ø–∞—Ç–µ–ª—é'))
   ```

2. **–í–∞–ª–æ–≤–∫–∞ (Gross Profit)**
   ```
   = –ü—Ä–æ–¥–∞–∂–∏ - (–ó–∞–∫—É–ø–æ—á–Ω–∞—è —Ü–µ–Ω–∞ √ó –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–æ–¥–∞–Ω–Ω—ã—Ö)
   ```

3. **–ù–∞—Ü–µ–Ω–∫–∞ %**
   ```
   = (–í–∞–ª–æ–≤–∫–∞ / –ü—Ä–æ–¥–∞–∂–∏) √ó 100
   ```

4. **–ü—Ä–æ–¥–≤–∏–∂–µ–Ω–∏–µ**
   ```
   = SUM(promotion_costs)
   ```

5. **–°—Ç–æ–∏–º–æ—Å—Ç—å —Ä–∞–∑–º–µ—â–µ–Ω–∏—è**
   ```
   = SUM(storage_costs)
   ```

6. **–≠–∫–≤–∞–π—Ä–∏–Ω–≥**
   ```
   = SUM(ozon_accruals WHERE accrual_type IN ('–û–ø–ª–∞—Ç–∞ —ç–∫–≤–∞–π—Ä–∏–Ω–≥–∞'))
   ```

7. **–ò—Ç–æ–≥–æ–≤–∞—è –º–∞—Ä–∂–∞ (—Ä—É–±)**
   ```
   = –í–∞–ª–æ–≤–∫–∞ - –ü—Ä–æ–¥–≤–∏–∂–µ–Ω–∏–µ - –°—Ç–æ–∏–º–æ—Å—Ç—å —Ä–∞–∑–º–µ—â–µ–Ω–∏—è - –≠–∫–≤–∞–π—Ä–∏–Ω–≥
   ```

8. **–ú–∞—Ä–∂–∏–Ω–∞–ª—å–Ω–æ—Å—Ç—å %**
   ```
   = (–ò—Ç–æ–≥–æ–≤–∞—è –º–∞—Ä–∂–∞ / –ü—Ä–æ–¥–∞–∂–∏) √ó 100
   ```

---

## üéØ –ü–ª–∞–Ω —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ Frontend

### –§–∞–∑–∞ 1: –ò–º–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö (Excel ‚Üí –ë–î)

#### 1.1 –°—Ç—Ä–∞–Ω–∏—Ü–∞ "–ò–º–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö" (`/app/import-data`)

**–ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:**
- Upload –∑–æ–Ω–∞ –¥–ª—è Excel —Ñ–∞–π–ª–æ–≤
- –í—ã–±–æ—Ä —Ç–∏–ø–∞ –∏–º–ø–æ—Ä—Ç–∞:
  - [ ] –ù–∞—á–∏—Å–ª–µ–Ω–∏—è –û–ó–û–ù (ozon_accruals)
  - [ ] –°—Ç–æ–∏–º–æ—Å—Ç—å —Ä–∞–∑–º–µ—â–µ–Ω–∏—è (storage_costs)
  - [ ] –ó–∞—Ç—Ä–∞—Ç—ã –Ω–∞ –ø—Ä–æ–¥–≤–∏–∂–µ–Ω–∏–µ (promotion_costs)
  - [ ] –ù–æ–º–µ–Ω–∫–ª–∞—Ç—É—Ä–∞ (product_business_data)
- –í—ã–±–æ—Ä –ø–µ—Ä–∏–æ–¥–∞ (–¥–∞—Ç—ã –Ω–∞—á–∞–ª–∞ –∏ –∫–æ–Ω—Ü–∞)
- –ò—Å—Ç–æ—Ä–∏—è –∏–º–ø–æ—Ä—Ç–æ–≤ (–∏–∑ import_logs)

**–õ–æ–≥–∏–∫–∞ –∏–º–ø–æ—Ä—Ç–∞:**
1. –ó–∞–≥—Ä—É–∑–∏—Ç—å Excel —Ñ–∞–π–ª
2. –ü–∞—Ä—Å–∏–Ω–≥ –¥–∞–Ω–Ω—ã—Ö (–±–∏–±–ª–∏–æ—Ç–µ–∫–∞ xlsx)
3. –í–∞–ª–∏–¥–∞—Ü–∏—è:
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞–ª–∏—á–∏–µ —Ç–æ–≤–∞—Ä–∞ –≤ `products` –ø–æ offer_id/SKU
   - –ï—Å–ª–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω ‚Üí **–∑–∞–ø—É—Å—Ç–∏—Ç—å API sync —Ç–æ–≤–∞—Ä–æ–≤**
   - –ü–æ–≤—Ç–æ—Ä–∏—Ç—å –ø–æ–ø—ã—Ç–∫—É –∏–º–ø–æ—Ä—Ç–∞ –ø–æ—Å–ª–µ sync
4. –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â—É—é —Ç–∞–±–ª–∏—Ü—É
5. –ó–∞–ø–∏—Å–∞—Ç—å –ª–æ–≥ –≤ `import_logs`

**–§–∞–π–ª—ã:**
- `src/pages/ImportData.tsx` - –æ—Å–Ω–æ–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞
- `src/components/import/FileUploader.tsx` - –∑–∞–≥—Ä—É–∑—á–∏–∫
- `src/components/import/ImportHistory.tsx` - –∏—Å—Ç–æ—Ä–∏—è
- `src/lib/excel-parser.ts` - –ø–∞—Ä—Å–∏–Ω–≥ Excel

#### 1.2 –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π SKU ‚Üí offer_id lookup

‚úÖ **–£–∂–µ —Å–æ–∑–¥–∞–Ω–∞ SQL —Ñ—É–Ω–∫—Ü–∏—è:** `find_offer_id_by_sku()`

**Frontend –∑–∞–¥–∞—á–∞:**
- –ü—Ä–∏ –∏–º–ø–æ—Ä—Ç–µ –≤—ã–∑—ã–≤–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏—é –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
- –ï—Å–ª–∏ offer_id –Ω–µ –Ω–∞–π–¥–µ–Ω ‚Üí API sync

---

### –§–∞–∑–∞ 2: Sales Analytics Dashboard

#### 2.1 –°—Ç—Ä–∞–Ω–∏—Ü–∞ "–ê–Ω–∞–ª–∏—Ç–∏–∫–∞ –ø—Ä–æ–¥–∞–∂" (`/app/sales-analytics`)

**Layout:**
```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  –í—ã–±–æ—Ä –ø–µ—Ä–∏–æ–¥–æ–≤:  [–ü–µ—Ä–∏–æ–¥ 1] vs [–ü–µ—Ä–∏–æ–¥ 2]        ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ  –§–∏–ª—å—Ç—Ä—ã: [–ö–∞—Ç–µ–≥–æ—Ä–∏—è] [–ü–æ—Å—Ç–∞–≤—â–∏–∫] [–¢–æ–≤–∞—Ä]         ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ  üìä –°–≤–æ–¥–Ω—ã–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏ (–∫–∞—Ä—Ç–æ—á–∫–∏)                   ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê     ‚îÇ
‚îÇ  ‚îÇ –ü—Ä–æ–¥–∞–∂–∏  ‚îÇ –í–∞–ª–æ–≤–∫–∞  ‚îÇ  –ú–∞—Ä–∂–∞   ‚îÇ –ú–∞—Ä–∂–∞ %  ‚îÇ     ‚îÇ
‚îÇ  ‚îÇ –ü–µ—Ä–∏–æ–¥ 1 ‚îÇ –ü–µ—Ä–∏–æ–¥ 1 ‚îÇ –ü–µ—Ä–∏–æ–¥ 1 ‚îÇ –ü–µ—Ä–∏–æ–¥ 1 ‚îÇ     ‚îÇ
‚îÇ  ‚îÇ –ü–µ—Ä–∏–æ–¥ 2 ‚îÇ –ü–µ—Ä–∏–æ–¥ 2 ‚îÇ –ü–µ—Ä–∏–æ–¥ 2 ‚îÇ –ü–µ—Ä–∏–æ–¥ 2 ‚îÇ     ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò     ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ  üìà –î–µ—Ç–∞–ª–∏–∑–∞—Ü–∏—è –ø–æ —Ç–æ–≤–∞—Ä–∞–º (—Ç–∞–±–ª–∏—Ü–∞)                ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îÇ
‚îÇ  ‚îÇ –ê—Ä—Ç–∏–∫—É–ª ‚îÇ –ù–∞–∑–≤–∞–Ω–∏–µ ‚îÇ –ü1 ‚îÇ –ü2 ‚îÇ –ú–∞—Ä–∂–∞ –ü1...‚îÇ    ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

**–ö–æ–ª–æ–Ω–∫–∏ —Ç–∞–±–ª–∏—Ü—ã:**
- –ê—Ä—Ç–∏–∫—É–ª
- –ù–∞–∑–≤–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞
- –ö–∞—Ç–µ–≥–æ—Ä–∏—è
- –ü–æ—Å—Ç–∞–≤—â–∏–∫
- **–ü–µ—Ä–∏–æ–¥ 1:**
  - –ü—Ä–æ–¥–∞–∂–∏ (—Ä—É–±)
  - –ü—Ä–æ–¥–∞–∂–∏ (—à—Ç)
  - –í–∞–ª–æ–≤–∫–∞ (—Ä—É–±)
  - –ù–∞—Ü–µ–Ω–∫–∞ %
  - –ü—Ä–æ–¥–≤–∏–∂–µ–Ω–∏–µ (—Ä—É–±)
  - –†–∞–∑–º–µ—â–µ–Ω–∏–µ (—Ä—É–±)
  - –≠–∫–≤–∞–π—Ä–∏–Ω–≥ (—Ä—É–±)
  - **–ú–∞—Ä–∂–∞ (—Ä—É–±)**
  - **–ú–∞—Ä–∂–∞ %**
- **–ü–µ—Ä–∏–æ–¥ 2:** (—Ç–æ –∂–µ —Å–∞–º–æ–µ)
- **–ò—Ç–æ–≥–æ:** (—Å—É–º–º–∞ –ø–µ—Ä–∏–æ–¥–æ–≤)

**SQL –∑–∞–ø—Ä–æ—Å (–∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏—é):**
```sql
SELECT * FROM get_sales_analytics(
  marketplace_id,
  period1_start,
  period1_end
)
```

**–§–∞–π–ª—ã:**
- `src/pages/SalesAnalytics.tsx` - –æ—Å–Ω–æ–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞
- `src/components/analytics/PeriodSelector.tsx` - –≤—ã–±–æ—Ä –ø–µ—Ä–∏–æ–¥–æ–≤
- `src/components/analytics/SalesTable.tsx` - —Ç–∞–±–ª–∏—Ü–∞ —Å –¥–∞–Ω–Ω—ã–º–∏
- `src/components/analytics/SalesCards.tsx` - –∫–∞—Ä—Ç–æ—á–∫–∏ —Å–≤–æ–¥–∫–∏
- `src/lib/sales-calculations.ts` - —Ñ–æ—Ä–º—É–ª—ã —Ä–∞—Å—á–µ—Ç–æ–≤

---

### –§–∞–∑–∞ 3: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –Ω–æ–º–µ–Ω–∫–ª–∞—Ç—É—Ä—ã

#### 3.1 –°—Ç—Ä–∞–Ω–∏—Ü–∞ "–ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Ç–æ–≤–∞—Ä–æ–≤" (`/app/product-settings`)

**–£–ª—É—á—à–µ–Ω–∏—è —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã:**
- ‚úÖ –£–∂–µ –µ—Å—Ç—å: –∫–∞—Ç–µ–≥–æ—Ä–∏—è, –ø–æ—Å—Ç–∞–≤—â–∏–∫, –∑–∞–∫—É–ø–æ—á–Ω–∞—è —Ü–µ–Ω–∞
- ‚ö†Ô∏è **–î–æ–±–∞–≤–∏—Ç—å:**
  - [ ] –í–∏–¥ –Ω–æ–º–µ–Ω–∫–ª–∞—Ç—É—Ä—ã (product_type) - dropdown
  - [ ] –ü–æ–¥–≤–∏–¥ –Ω–æ–º–µ–Ω–∫–ª–∞—Ç—É—Ä—ã (product_subtype) - dropdown
  - [ ] –ó–∞–≥—Ä—É–∑–∫–∞ —ç—Ç–∏—Ö –ø–æ–ª–µ–π –∏–∑ Excel

**–í–∞–ª–∏–¥–∞—Ü–∏—è:**
- –§–ª–∞–≥ `is_complete` - –≤—Å–µ –ø–æ–ª—è –∑–∞–ø–æ–ª–Ω–µ–Ω—ã?
- –ú–∞—Å—Å–∏–≤ `missing_fields` - –∫–∞–∫–∏–µ –ø–æ–ª—è –ø—É—Å—Ç—ã–µ

**–ò–º–ø–æ—Ä—Ç Excel –¥–ª—è –Ω–æ–º–µ–Ω–∫–ª–∞—Ç—É—Ä—ã:**

–§–æ—Ä–º–∞—Ç —Ñ–∞–π–ª–∞:
```
| –ê—Ä—Ç–∏–∫—É–ª | –ü–æ—Å—Ç–∞–≤—â–∏–∫ | –ö–∞—Ç–µ–≥–æ—Ä–∏—è | –í–∏–¥ | –ü–æ–¥–≤–∏–¥ | –ó–∞–∫—É–ø–æ—á–Ω–∞—è —Ü–µ–Ω–∞ |
```

---

### –§–∞–∑–∞ 4: –ö–æ–Ω—Ç—Ä–æ–ª—å –æ–±—ä–µ–º–Ω—ã—Ö —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫ (–ª–∏—Ç—Ä–∞–∂)

#### 4.1 –°—Ç—Ä–∞–Ω–∏—Ü–∞ "–ö–æ–Ω—Ç—Ä–æ–ª—å –ª–∏—Ç—Ä–∞–∂–∞" (`/app/volume-control`)

**–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª:**

1. **–£—Å—Ç–∞–Ω–æ–≤–∫–∞ —ç—Ç–∞–ª–æ–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π:**
   - –í—ã–±—Ä–∞—Ç—å —Ç–æ–≤–∞—Ä
   - –£–∫–∞–∑–∞—Ç—å —ç—Ç–∞–ª–æ–Ω–Ω—ã–π –ª–∏—Ç—Ä–∞–∂ (volume_liters)
   - –î–æ–ø—É—Å—Ç–∏–º–æ–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ % (tolerance_percent, –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 5%)

2. **–ï–∂–µ–¥–Ω–µ–≤–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è):**
   - –ü–æ–ª—É—á–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –∏–∑ OZON API (–µ–∂–µ–¥–Ω–µ–≤–Ω–æ)
   - –°—Ä–∞–≤–Ω–∏–≤–∞—Ç—å —Å —ç—Ç–∞–ª–æ–Ω–æ–º
   - –ï—Å–ª–∏ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ > tolerance ‚Üí —Ñ–ª–∞–≥ `is_different_from_standard = true`
   - –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é

3. **–ò—Å—Ç–æ—Ä–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π:**
   - –¢–∞–±–ª–∏—Ü–∞ —Å –∏—Å—Ç–æ—Ä–∏–µ–π –ª–∏—Ç—Ä–∞–∂–∞ –ø–æ –¥–∞—Ç–∞–º
   - –§–∏–ª—å—Ç—Ä: "–¢–æ–ª—å–∫–æ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏—è"
   - –ì—Ä–∞—Ñ–∏–∫ –∏–∑–º–µ–Ω–µ–Ω–∏—è –ª–∏—Ç—Ä–∞–∂–∞ –ø–æ –≤—Ä–µ–º–µ–Ω–∏

4. **Trigger –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π (—É–∂–µ –µ—Å—Ç—å –≤ –ë–î):**
   ```sql
   CREATE TRIGGER trigger_check_volume_deviation
     BEFORE INSERT OR UPDATE ON product_volume_history
     FOR EACH ROW
     EXECUTE FUNCTION check_volume_deviation();
   ```

**–§–∞–π–ª—ã:**
- `src/pages/VolumeControl.tsx` - –æ—Å–Ω–æ–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞
- `src/components/volume/SetStandards.tsx` - —É—Å—Ç–∞–Ω–æ–≤–∫–∞ —ç—Ç–∞–ª–æ–Ω–æ–≤
- `src/components/volume/VolumeHistory.tsx` - –∏—Å—Ç–æ—Ä–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π
- `src/components/volume/VolumeAlerts.tsx` - –∞–ª–µ—Ä—Ç—ã

---

## üîß –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –∑–∞–¥–∞—á–∏

### 1. API Endpoints (Supabase Edge Functions)

#### 1.1 –ò–º–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö
- `POST /import-accruals` - –∏–º–ø–æ—Ä—Ç –Ω–∞—á–∏—Å–ª–µ–Ω–∏–π
- `POST /import-storage-costs` - –∏–º–ø–æ—Ä—Ç —Å—Ç–æ–∏–º–æ—Å—Ç–∏ —Ä–∞–∑–º–µ—â–µ–Ω–∏—è
- `POST /import-promotion-costs` - –∏–º–ø–æ—Ä—Ç –∑–∞—Ç—Ä–∞—Ç –Ω–∞ —Ä–µ–∫–ª–∞–º—É
- `POST /import-business-data` - –∏–º–ø–æ—Ä—Ç –Ω–æ–º–µ–Ω–∫–ª–∞—Ç—É—Ä—ã

#### 1.2 –ê–Ω–∞–ª–∏—Ç–∏–∫–∞
- `GET /sales-analytics?period1_start=...&period1_end=...&period2_start=...&period2_end=...`
  - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç SQL —Ñ—É–Ω–∫—Ü–∏—é `get_sales_analytics()`
  - –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –∑–∞ 2 –ø–µ—Ä–∏–æ–¥–∞
  - –ü—Ä–∏–º–µ–Ω—è–µ—Ç —Ñ–æ—Ä–º—É–ª—ã —Ä–∞—Å—á–µ—Ç–æ–≤

#### 1.3 –ö–æ–Ω—Ç—Ä–æ–ª—å –ª–∏—Ç—Ä–∞–∂–∞
- `GET /volume-check` - –ø—Ä–æ–≤–µ—Ä–∫–∞ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–π –ª–∏—Ç—Ä–∞–∂–∞
- `POST /volume-sync` - —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö —Å OZON API
- `POST /set-volume-standard` - —É—Å—Ç–∞–Ω–æ–≤–∫–∞ —ç—Ç–∞–ª–æ–Ω–∞

### 2. –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è

#### 2.1 Scheduled Jobs (Supabase CRON)
```sql
-- –ï–∂–µ–¥–Ω–µ–≤–Ω–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –ª–∏—Ç—Ä–∞–∂–∞ –∏–∑ OZON API
SELECT cron.schedule(
  'sync-volume-daily',
  '0 2 * * *',  -- –ö–∞–∂–¥—ã–π –¥–µ–Ω—å –≤ 2:00
  'SELECT sync_product_volumes()'
);
```

#### 2.2 –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π API sync –ø—Ä–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ —Ç–æ–≤–∞—Ä–∞
- –ü—Ä–∏ –∏–º–ø–æ—Ä—Ç–µ: –µ—Å–ª–∏ offer_id –Ω–µ –Ω–∞–π–¥–µ–Ω –≤ `products`
- –ó–∞–ø—É—Å—Ç–∏—Ç—å `sync-products` Edge Function
- –ü–æ–≤—Ç–æ—Ä–∏—Ç—å –∏–º–ø–æ—Ä—Ç

---

## üìä –¢–∏–ø—ã –Ω–∞—á–∏—Å–ª–µ–Ω–∏–π OZON (–¥–ª—è —Ñ–∏–ª—å—Ç—Ä–æ–≤)

–ò–∑ –º–∞–∫—Ä–æ—Å–æ–≤ –∏–∑–≤–µ—Å—Ç–Ω–æ —á—Ç–æ –Ω—É–∂–Ω–æ —Ä–∞–∑–ª–∏—á–∞—Ç—å:

**–ü—Ä–æ–¥–∞–∂–∏:**
- "–î–æ—Å—Ç–∞–≤–∫–∞ –ø–æ–∫—É–ø–∞—Ç–µ–ª—é"
- (–≤–æ–∑–º–æ–∂–Ω–æ –¥—Ä—É–≥–∏–µ —Ç–∏–ø—ã –ø—Ä–æ–¥–∞–∂)

**–≠–∫–≤–∞–π—Ä–∏–Ω–≥:**
- "–û–ø–ª–∞—Ç–∞ —ç–∫–≤–∞–π—Ä–∏–Ω–≥–∞"

**–ü—Ä–æ—á–∏–µ –Ω–∞—á–∏—Å–ª–µ–Ω–∏—è:**
- –ö–æ–º–∏—Å—Å–∏–∏
- –í–æ–∑–≤—Ä–∞—Ç—ã
- –∏ —Ç.–¥.

‚ö†Ô∏è **–ù—É–∂–Ω–æ —É—Ç–æ—á–Ω–∏—Ç—å –ø–æ–ª–Ω—ã–π —Å–ø–∏—Å–æ–∫ —Ç–∏–ø–æ–≤ –Ω–∞—á–∏—Å–ª–µ–Ω–∏–π –∏–∑ —Ä–µ–∞–ª—å–Ω—ã—Ö –æ—Ç—á–µ—Ç–æ–≤ OZON**

---

## ‚úÖ –ß–µ–∫–ª–∏—Å—Ç —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

### –ë–î –∏ –º–∏–≥—Ä–∞—Ü–∏–∏
- [x] –¢–∞–±–ª–∏—Ü–∞ `suppliers`
- [x] –¢–∞–±–ª–∏—Ü–∞ `product_business_data`
- [x] –¢–∞–±–ª–∏—Ü–∞ `ozon_accruals`
- [x] –¢–∞–±–ª–∏—Ü–∞ `storage_costs`
- [x] –¢–∞–±–ª–∏—Ü–∞ `promotion_costs`
- [x] –¢–∞–±–ª–∏—Ü–∞ `product_volume_standards`
- [x] –¢–∞–±–ª–∏—Ü–∞ `product_volume_history`
- [x] –¢–∞–±–ª–∏—Ü–∞ `import_logs`
- [x] SQL —Ñ—É–Ω–∫—Ü–∏—è `find_offer_id_by_sku()`
- [x] SQL —Ñ—É–Ω–∫—Ü–∏—è `get_sales_analytics()`
- [x] Trigger `check_volume_deviation()`

### Frontend - –ò–º–ø–æ—Ä—Ç
- [ ] –°—Ç—Ä–∞–Ω–∏—Ü–∞ "–ò–º–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö"
- [ ] –ö–æ–º–ø–æ–Ω–µ–Ω—Ç –∑–∞–≥—Ä—É–∑–∫–∏ Excel
- [ ] –ü–∞—Ä—Å–∏–Ω–≥ Excel —Ñ–∞–π–ª–æ–≤ (–±–∏–±–ª–∏–æ—Ç–µ–∫–∞ xlsx)
- [ ] –í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö –ø–µ—Ä–µ–¥ –∏–º–ø–æ—Ä—Ç–æ–º
- [ ] –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –∑–∞–ø—É—Å–∫ API sync –ø—Ä–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ —Ç–æ–≤–∞—Ä–∞
- [ ] –ò—Å—Ç–æ—Ä–∏—è –∏–º–ø–æ—Ä—Ç–æ–≤

### Frontend - –ê–Ω–∞–ª–∏—Ç–∏–∫–∞
- [ ] –°—Ç—Ä–∞–Ω–∏—Ü–∞ "Sales Analytics"
- [ ] –í—ã–±–æ—Ä 2 –ø–µ—Ä–∏–æ–¥–æ–≤ –¥–ª—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è
- [ ] –ö–∞—Ä—Ç–æ—á–∫–∏ —Å —Å–≤–æ–¥–Ω—ã–º–∏ –ø–æ–∫–∞–∑–∞—Ç–µ–ª—è–º–∏
- [ ] –¢–∞–±–ª–∏—Ü–∞ –¥–µ—Ç–∞–ª–∏–∑–∞—Ü–∏–∏ –ø–æ —Ç–æ–≤–∞—Ä–∞–º
- [ ] –†–µ–∞–ª–∏–∑–∞—Ü–∏—è —Ñ–æ—Ä–º—É–ª —Ä–∞—Å—á–µ—Ç–æ–≤ (–≤–∞–ª–æ–≤–∫–∞, –º–∞—Ä–∂–∞, –Ω–∞—Ü–µ–Ω–∫–∞)
- [ ] –§–∏–ª—å—Ç—Ä—ã (–∫–∞—Ç–µ–≥–æ—Ä–∏—è, –ø–æ—Å—Ç–∞–≤—â–∏–∫, —Ç–æ–≤–∞—Ä)
- [ ] –≠–∫—Å–ø–æ—Ä—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –≤ Excel

### Frontend - –ù–æ–º–µ–Ω–∫–ª–∞—Ç—É—Ä–∞
- [ ] –î–æ–±–∞–≤–∏—Ç—å –ø–æ–ª—è "–í–∏–¥" –∏ "–ü–æ–¥–≤–∏–¥" –≤ ProductSettings
- [ ] –ò–º–ø–æ—Ä—Ç –Ω–æ–º–µ–Ω–∫–ª–∞—Ç—É—Ä—ã –∏–∑ Excel
- [ ] –í–∞–ª–∏–¥–∞—Ü–∏—è –ø–æ–ª–Ω–æ—Ç—ã –¥–∞–Ω–Ω—ã—Ö (is_complete, missing_fields)

### Frontend - –ö–æ–Ω—Ç—Ä–æ–ª—å –ª–∏—Ç—Ä–∞–∂–∞
- [ ] –°—Ç—Ä–∞–Ω–∏—Ü–∞ "–ö–æ–Ω—Ç—Ä–æ–ª—å –ª–∏—Ç—Ä–∞–∂–∞"
- [ ] –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —ç—Ç–∞–ª–æ–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π
- [ ] –ò—Å—Ç–æ—Ä–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π –ª–∏—Ç—Ä–∞–∂–∞
- [ ] –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ–± –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏—è—Ö
- [ ] –ì—Ä–∞—Ñ–∏–∫ –∏–∑–º–µ–Ω–µ–Ω–∏—è –ª–∏—Ç—Ä–∞–∂–∞

### API & –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è
- [ ] Edge Function: –∏–º–ø–æ—Ä—Ç –Ω–∞—á–∏—Å–ª–µ–Ω–∏–π
- [ ] Edge Function: –∏–º–ø–æ—Ä—Ç —Å—Ç–æ–∏–º–æ—Å—Ç–∏ —Ä–∞–∑–º–µ—â–µ–Ω–∏—è
- [ ] Edge Function: –∏–º–ø–æ—Ä—Ç –∑–∞—Ç—Ä–∞—Ç –Ω–∞ —Ä–µ–∫–ª–∞–º—É
- [ ] Edge Function: –ø–æ–ª—É—á–µ–Ω–∏–µ sales analytics
- [ ] Edge Function: —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –ª–∏—Ç—Ä–∞–∂–∞ –∏–∑ OZON API
- [ ] Scheduled Job: –µ–∂–µ–¥–Ω–µ–≤–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –ª–∏—Ç—Ä–∞–∂–∞
- [ ] Scheduled Job: –µ–∂–µ–¥–Ω–µ–≤–Ω—ã–π API sync —Ç–æ–≤–∞—Ä–æ–≤

---

## üöÄ –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç—ã

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 1 (MVP):
1. –°—Ç—Ä–∞–Ω–∏—Ü–∞ –∏–º–ø–æ—Ä—Ç–∞ –¥–∞–Ω–Ω—ã—Ö (–Ω–∞—á–∏—Å–ª–µ–Ω–∏—è, —Ä–∞–∑–º–µ—â–µ–Ω–∏–µ, –ø—Ä–æ–¥–≤–∏–∂–µ–Ω–∏–µ)
2. –°—Ç—Ä–∞–Ω–∏—Ü–∞ Sales Analytics —Å –±–∞–∑–æ–≤—ã–º–∏ —Ä–∞—Å—á–µ—Ç–∞–º–∏
3. –î–æ–ø–æ–ª–Ω–∏—Ç—å ProductSettings –ø–æ–ª—è–º–∏ "–í–∏–¥" –∏ "–ü–æ–¥–≤–∏–¥"

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 2:
4. –ö–æ–Ω—Ç—Ä–æ–ª—å –ª–∏—Ç—Ä–∞–∂–∞ (—ç—Ç–∞–ª–æ–Ω—ã + –∏—Å—Ç–æ—Ä–∏—è)
5. –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è API sync –ø—Ä–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ —Ç–æ–≤–∞—Ä–∞

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 3:
6. Scheduled Jobs –¥–ª—è –µ–∂–µ–¥–Ω–µ–≤–Ω—ã—Ö –ø—Ä–æ–≤–µ—Ä–æ–∫
7. –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ–± –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏—è—Ö
8. –≠–∫—Å–ø–æ—Ä—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

---

## üìö –°–ø—Ä–∞–≤–æ—á–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è

### –†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏:
- **–¢–µ–∫—É—â–∏–π –ø—Ä–æ–µ–∫—Ç:** `/home/user/standalone-spark`
- **Excel –º–∞–∫—Ä–æ—Å—ã:** —Ä–µ–ø–æ `excel-macros` (–Ω–µ –Ω–∞–π–¥–µ–Ω –Ω–∞ —ç—Ç–æ–π –º–∞—à–∏–Ω–µ)

### –ò—Å—Ç–æ—á–Ω–∏–∫–∏:
- –ü–µ—Ä–µ–ø–∏—Å–∫–∞ –∏–∑ –ø—Ä–æ—à–ª–æ–≥–æ —á–∞—Ç–∞
- –°—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –º–∏–≥—Ä–∞—Ü–∏–∏ –ë–î
- –õ–æ–≥–∏–∫–∞ Excel –º–∞–∫—Ä–æ—Å–æ–≤

---

**–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ:** 07.12.2025, 03:30 MSK
