# üßπ –ü–†–ê–í–ò–õ–ê –û–ß–ò–°–¢–ö–ò –õ–û–ì–û–í –í –ë–ê–ó–ï –î–ê–ù–ù–´–•

**–î–∞—Ç–∞ –∞–Ω–∞–ª–∏–∑–∞:** 2026-01-25
**–°—Ç–∞—Ç—É—Å:** –¢—Ä–µ–±—É–µ—Ç —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏—è

---

## üìä –¢–ï–ö–£–©–ï–ï –°–û–°–¢–û–Ø–ù–ò–ï

### –ê–∫—Ç–∏–≤–Ω—ã–µ CRON –∑–∞–¥–∞—á–∏

| ‚Ññ | –ù–∞–∑–≤–∞–Ω–∏–µ | –†–∞—Å–ø–∏—Å–∞–Ω–∏–µ | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ | –°—Ç–∞—Ç—É—Å |
|---|----------|------------|------------|--------|
| 1 | `auto-generate-drafts-cron` | –ö–∞–∂–¥—ã–µ 5 –º–∏–Ω—É—Ç | –ê–≤—Ç–æ–≥–µ–Ω–µ—Ä–∞—Ü–∏—è —á–µ—Ä–Ω–æ–≤–∏–∫–æ–≤ –æ—Ç–≤–µ—Ç–æ–≤ | ‚úÖ –ê–∫—Ç–∏–≤–Ω–∞ |
| 2 | `ozon-performance-daily-sync` | –ï–∂–µ–¥–Ω–µ–≤–Ω–æ 02:00 UTC | –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è OZON Performance API | ‚úÖ –ê–∫—Ç–∏–≤–Ω–∞ |
| 3 | `cleanup-audit-log-hourly` | –ö–∞–∂–¥—ã–π —á–∞—Å | –û—á–∏—Å—Ç–∫–∞ audit_log (1000 –∑–∞–ø–∏—Å–µ–π) | ‚úÖ –ê–∫—Ç–∏–≤–Ω–∞ |
| 4 | `cleanup-ozon-sync-logs-daily` | –ï–∂–µ–¥–Ω–µ–≤–Ω–æ 03:00 UTC | –û—á–∏—Å—Ç–∫–∞ –ª–æ–≥–æ–≤ ozon_sync | ‚úÖ –ê–∫—Ç–∏–≤–Ω–∞ |
| 5 | `cleanup-audit-log-urgent` | –ö–∞–∂–¥—É—é –º–∏–Ω—É—Ç—É | –°—Ä–æ—á–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞ audit_log (500 –∑–∞–ø–∏—Å–µ–π) | ‚ö†Ô∏è –í—Ä–µ–º–µ–Ω–Ω–∞—è |
| 6 | `process-scheduled-replies` | –ö–∞–∂–¥—É—é –º–∏–Ω—É—Ç—É | –û–±—Ä–∞–±–æ—Ç–∫–∞ –∑–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –æ—Ç–≤–µ—Ç–æ–≤ | ‚ö†Ô∏è –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∞–∫—Ç—É–∞–ª—å–Ω–æ—Å—Ç—å |
| 7 | `sync-ozon-marketplaces` | –ö–∞–∂–¥—ã–µ 2 —á–∞—Å–∞ | –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è OZON –º–∞—Ä–∫–µ—Ç–ø–ª–µ–π—Å–æ–≤ | ‚ö†Ô∏è –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∞–∫—Ç—É–∞–ª—å–Ω–æ—Å—Ç—å |

### –¢–∞–±–ª–∏—Ü—ã —Å –ª–æ–≥–∞–º–∏ (–ø–æ —Ä–∞–∑–º–µ—Ä—É)

| ‚Ññ | –¢–∞–±–ª–∏—Ü–∞ | –†–∞–∑–º–µ—Ä (–∏–∑ —Å–∫—Ä–∏–Ω—à–æ—Ç–∞) | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ | –ö—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç—å |
|---|---------|----------------------|------------|-------------|
| 1 | `audit_log` | ~126 MB | –õ–æ–≥–∏ –¥–µ–π—Å—Ç–≤–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π | üî¥ –í–´–°–û–ö–ê–Ø |
| 2 | `job_run_details` (cron) | ~59 MB | –õ–æ–≥–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è CRON –∑–∞–¥–∞—á | üü° –°–†–ï–î–ù–Ø–Ø |
| 3 | `replicas` | ~336 MB | –î–∞–Ω–Ω—ã–µ —Ä–µ–ø–ª–∏–∫–∞—Ü–∏–∏ (?) | ‚ö†Ô∏è –¢—Ä–µ–±—É–µ—Ç —É—Ç–æ—á–Ω–µ–Ω–∏—è |
| 4 | `user_accruals` | ~73 MB | –ù–∞—á–∏—Å–ª–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º | üü¢ –†–ê–ë–û–ß–ò–ï –î–ê–ù–ù–´–ï |
| 5 | `storage_costs` | ~23 MB | –ó–∞—Ç—Ä–∞—Ç—ã –Ω–∞ —Ö—Ä–∞–Ω–µ–Ω–∏–µ | üü¢ –†–ê–ë–û–ß–ò–ï –î–ê–ù–ù–´–ï |
| 6 | `reviews` | ~53 MB | –û—Ç–∑—ã–≤—ã | üü¢ –†–ê–ë–û–ß–ò–ï –î–ê–ù–ù–´–ï |
| 7 | `products` | ~5448 KB | –¢–æ–≤–∞—Ä—ã | üü¢ –†–ê–ë–û–ß–ò–ï –î–ê–ù–ù–´–ï |
| 8 | `ozon_sync_history` | –ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ | –ò—Å—Ç–æ—Ä–∏—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–π OZON | üü° –°–†–ï–î–ù–Ø–Ø |
| 9 | `import_logs` | –ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ | –õ–æ–≥–∏ –∏–º–ø–æ—Ä—Ç–∞ —Ñ–∞–π–ª–æ–≤ | üü° –°–†–ï–î–ù–Ø–Ø |
| 10 | `logs_ai` | –ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ | –õ–æ–≥–∏ –æ—à–∏–±–æ–∫ AI –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ | üü° –°–†–ï–î–ù–Ø–Ø |
| 11 | `ai_reply_history` | –ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ | –ò—Å—Ç–æ—Ä–∏—è —Ä–µ–≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ AI –æ—Ç–≤–µ—Ç–æ–≤ | üü° –°–†–ï–î–ù–Ø–Ø |
| 12 | `consent_logs` | –ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ | –õ–æ–≥–∏ —Å–æ–≥–ª–∞—Å–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π | üü° –°–†–ï–î–ù–Ø–Ø |
| 13 | `fallback_action_logs` | –ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ | –õ–æ–≥–∏ fallback –¥–µ–π—Å—Ç–≤–∏–π | üü° –°–†–ï–î–ù–Ø–Ø |
| 14 | `product_volume_history` | –ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ | –ò—Å—Ç–æ—Ä–∏—è –æ–±—ä–µ–º–æ–≤ —Ç–æ–≤–∞—Ä–æ–≤ | üü¢ –†–ê–ë–û–ß–ò–ï –î–ê–ù–ù–´–ï |

---

## üéØ –ü–†–ï–î–õ–ê–ì–ê–ï–ú–´–ï –ü–†–ê–í–ò–õ–ê –û–ß–ò–°–¢–ö–ò

### 1. audit_log (–ö–†–ò–¢–ò–ß–ù–û - 126 MB)

**–¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ:**
- ‚úÖ –£–∂–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∞ –∞–≤—Ç–æ–æ—á–∏—Å—Ç–∫–∞: `cleanup-audit-log-hourly` (–∫–∞–∂–¥—ã–π —á–∞—Å, 1000 –∑–∞–ø–∏—Å–µ–π)
- ‚úÖ –ï—Å—Ç—å —Å—Ä–æ—á–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞: `cleanup-audit-log-urgent` (–∫–∞–∂–¥—É—é –º–∏–Ω—É—Ç—É, 500 –∑–∞–ø–∏—Å–µ–π)

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:**
```
‚úÖ –û–°–¢–ê–í–ò–¢–¨ —Ç–µ–∫—É—â—É—é —Å—Ö–µ–º—É:
   - –ü–µ—Ä–∏–æ–¥ —Ö—Ä–∞–Ω–µ–Ω–∏—è: 7 –¥–Ω–µ–π
   - –ê–≤—Ç–æ–æ—á–∏—Å—Ç–∫–∞: –∫–∞–∂–¥—ã–π —á–∞—Å –ø–æ 1000 –∑–∞–ø–∏—Å–µ–π
   - –°—Ä–æ—á–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞ –æ—Ç–∫–ª—é—á–∏—Ç—å –ø–æ—Å–ª–µ —É—Å—Ç—Ä–∞–Ω–µ–Ω–∏—è backlog

‚ö†Ô∏è –î–ï–ô–°–¢–í–ò–Ø:
   1. –î–æ–∂–¥–∞—Ç—å—Å—è –æ—á–∏—Å—Ç–∫–∏ backlog (3-5 —á–∞—Å–æ–≤)
   2. –û—Ç–∫–ª—é—á–∏—Ç—å cleanup-audit-log-urgent
   3. –û—Å—Ç–∞–≤–∏—Ç—å cleanup-audit-log-hourly –Ω–∞ –ø–æ—Å—Ç–æ—è–Ω–Ω–æ–π –æ—Å–Ω–æ–≤–µ
```

**SQL –¥–ª—è –æ—Ç–∫–ª—é—á–µ–Ω–∏—è —Å—Ä–æ—á–Ω–æ–π –æ—á–∏—Å—Ç–∫–∏ (–≤—ã–ø–æ–ª–Ω–∏—Ç—å –ü–û–°–õ–ï –æ—á–∏—Å—Ç–∫–∏ backlog):**
```sql
SELECT cron.unschedule('cleanup-audit-log-urgent');
```

---

### 2. ozon_sync_history (–ò—Å—Ç–æ—Ä–∏—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–π OZON)

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:**
- –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –ª–æ–≥–∏ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ —Å OZON Performance API
- –ò—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏ –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞

**–¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ:**
- ‚ùå –ê–≤—Ç–æ–æ—á–∏—Å—Ç–∫–∞ –ù–ï –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∞

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:**
```
‚úÖ –ù–ê–°–¢–†–û–ò–¢–¨ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫—É—é –æ—á–∏—Å—Ç–∫—É:
   - –ü–µ—Ä–∏–æ–¥ —Ö—Ä–∞–Ω–µ–Ω–∏—è: 30 –¥–Ω–µ–π (–¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –ø—Ä–æ–±–ª–µ–º –∑–∞ –º–µ—Å—è—Ü)
   - –†–∞—Å–ø–∏—Å–∞–Ω–∏–µ: –µ–∂–µ–¥–Ω–µ–≤–Ω–æ –≤ 04:00 UTC
   - –ë–∞—Ç—á-—Ä–∞–∑–º–µ—Ä: 10,000 –∑–∞–ø–∏—Å–µ–π –∑–∞ —Ä–∞–∑
```

**–û–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ:**
- –ò—Å—Ç–æ—Ä–∏—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–π –Ω—É–∂–Ω–∞ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏, –Ω–æ —Å—Ç–∞—Ä—à–µ 30 –¥–Ω–µ–π –Ω–µ –∞–∫—Ç—É–∞–ª—å–Ω–∞
- –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –µ–∂–µ–¥–Ω–µ–≤–Ω–æ ‚Üí ~30 –∑–∞–ø–∏—Å–µ–π –≤ –¥–µ–Ω—å
- –ó–∞ –≥–æ–¥ –Ω–∞–∫–æ–ø–∏—Ç—Å—è ~11,000 –∑–∞–ø–∏—Å–µ–π ‚Üí –ª—É—á—à–µ –æ–≥—Ä–∞–Ω–∏—á–∏—Ç—å 30 –¥–Ω—è–º–∏

---

### 3. import_logs (–õ–æ–≥–∏ –∏–º–ø–æ—Ä—Ç–∞ —Ñ–∞–π–ª–æ–≤)

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:**
- –õ–æ–≥–∏ –∑–∞–≥—Ä—É–∑–∫–∏ —Ñ–∞–π–ª–æ–≤ —Å –¥–∞–Ω–Ω—ã–º–∏ (accruals, storage_costs, etc.)
- –ò—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è —É—Å–ø–µ—à–Ω–æ—Å—Ç–∏ –∏–º–ø–æ—Ä—Ç–∞

**–¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ:**
- ‚ùå –ê–≤—Ç–æ–æ—á–∏—Å—Ç–∫–∞ –ù–ï –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∞

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:**
```
‚úÖ –ù–ê–°–¢–†–û–ò–¢–¨ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫—É—é –æ—á–∏—Å—Ç–∫—É:
   - –ü–µ—Ä–∏–æ–¥ —Ö—Ä–∞–Ω–µ–Ω–∏—è: 90 –¥–Ω–µ–π (3 –º–µ—Å—è—Ü–∞)
   - –†–∞—Å–ø–∏—Å–∞–Ω–∏–µ: –µ–∂–µ–Ω–µ–¥–µ–ª—å–Ω–æ –≤ –≤–æ—Å–∫—Ä–µ—Å–µ–Ω—å–µ 05:00 UTC
   - –ë–∞—Ç—á-—Ä–∞–∑–º–µ—Ä: 5,000 –∑–∞–ø–∏—Å–µ–π –∑–∞ —Ä–∞–∑
```

**–û–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ:**
- –õ–æ–≥–∏ –∏–º–ø–æ—Ä—Ç–∞ –º–æ–≥—É—Ç –ø–æ–Ω–∞–¥–æ–±–∏—Ç—å—Å—è –¥–ª—è –∞—É–¥–∏—Ç–∞ –∑–∞ –Ω–µ—Å–∫–æ–ª—å–∫–æ –º–µ—Å—è—Ü–µ–≤
- 90 –¥–Ω–µ–π ‚Äî —Ä–∞–∑—É–º–Ω—ã–π –±–∞–ª–∞–Ω—Å –º–µ–∂–¥—É –∞—É–¥–∏—Ç–æ–º –∏ —ç–∫–æ–Ω–æ–º–∏–µ–π –º–µ—Å—Ç–∞

---

### 4. logs_ai (–õ–æ–≥–∏ –æ—à–∏–±–æ–∫ AI)

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:**
- –õ–æ–≥–∏ –æ—à–∏–±–æ–∫ –ø—Ä–∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ AI –æ—Ç–≤–µ—Ç–æ–≤
- –ò—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –∫–∞—á–µ—Å—Ç–≤–∞ AI

**–¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ:**
- ‚ùå –ê–≤—Ç–æ–æ—á–∏—Å—Ç–∫–∞ –ù–ï –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∞

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:**
```
‚úÖ –ù–ê–°–¢–†–û–ò–¢–¨ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫—É—é –æ—á–∏—Å—Ç–∫—É:
   - –ü–µ—Ä–∏–æ–¥ —Ö—Ä–∞–Ω–µ–Ω–∏—è: 14 –¥–Ω–µ–π
   - –†–∞—Å–ø–∏—Å–∞–Ω–∏–µ: –µ–∂–µ–¥–Ω–µ–≤–Ω–æ –≤ 05:00 UTC
   - –ë–∞—Ç—á-—Ä–∞–∑–º–µ—Ä: 5,000 –∑–∞–ø–∏—Å–µ–π –∑–∞ —Ä–∞–∑
```

**–û–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ:**
- –û—à–∏–±–∫–∏ AI –Ω—É–∂–Ω—ã —Ç–æ–ª—å–∫–æ –¥–ª—è –æ–ø–µ—Ä–∞—Ç–∏–≤–Ω–æ–π –æ—Ç–ª–∞–¥–∫–∏
- –°—Ç–∞—Ä—ã–µ –æ—à–∏–±–∫–∏ (>14 –¥–Ω–µ–π) —É–∂–µ –Ω–µ –∞–∫—Ç—É–∞–ª—å–Ω—ã –¥–ª—è –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è
- AI –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è —á–∞—Å—Ç–æ ‚Üí –ª–æ–≥–æ–≤ –º–æ–∂–µ—Ç –±—ã—Ç—å –º–Ω–æ–≥–æ

---

### 5. ai_reply_history (–ò—Å—Ç–æ—Ä–∏—è —Ä–µ–≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ AI –æ—Ç–≤–µ—Ç–æ–≤)

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:**
- –ò—Å—Ç–æ—Ä–∏—è –≤—Å–µ—Ö –≤–µ—Ä—Å–∏–π AI –æ—Ç–≤–µ—Ç–æ–≤ (–¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π)
- –ú–æ–∂–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –∫–∞—á–µ—Å—Ç–≤–∞

**–¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ:**
- ‚ùå –ê–≤—Ç–æ–æ—á–∏—Å—Ç–∫–∞ –ù–ï –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∞

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:**
```
‚ö†Ô∏è –û–ë–°–£–î–ò–¢–¨ —Å –∫–æ–º–∞–Ω–¥–æ–π:

–í–ê–†–ò–ê–ù–¢ 1 (–∫–æ–Ω—Å–µ—Ä–≤–∞—Ç–∏–≤–Ω—ã–π):
   - –ü–µ—Ä–∏–æ–¥ —Ö—Ä–∞–Ω–µ–Ω–∏—è: 180 –¥–Ω–µ–π (6 –º–µ—Å—è—Ü–µ–≤)
   - –†–∞—Å–ø–∏—Å–∞–Ω–∏–µ: –µ–∂–µ–Ω–µ–¥–µ–ª—å–Ω–æ –≤ –≤–æ—Å–∫—Ä–µ—Å–µ–Ω—å–µ 06:00 UTC

–í–ê–†–ò–ê–ù–¢ 2 (–∞–≥—Ä–µ—Å—Å–∏–≤–Ω—ã–π):
   - –ü–µ—Ä–∏–æ–¥ —Ö—Ä–∞–Ω–µ–Ω–∏—è: 30 –¥–Ω–µ–π
   - –†–∞—Å–ø–∏—Å–∞–Ω–∏–µ: –µ–∂–µ–Ω–µ–¥–µ–ª—å–Ω–æ –≤ –≤–æ—Å–∫—Ä–µ—Å–µ–Ω—å–µ 06:00 UTC

–í–ê–†–ò–ê–ù–¢ 3 (–∞—Ä—Ö–∏–≤–∏—Ä–æ–≤–∞–Ω–∏–µ):
   - –ù–ï –£–î–ê–õ–Ø–¢–¨, –Ω–æ –ø–µ—Ä–µ–Ω–µ—Å—Ç–∏ —Å—Ç–∞—Ä—ã–µ –∑–∞–ø–∏—Å–∏ –≤ –∞—Ä—Ö–∏–≤–Ω—É—é —Ç–∞–±–ª–∏—Ü—É
   - –ú–æ–∂–µ—Ç –ø—Ä–∏–≥–æ–¥–∏—Ç—å—Å—è –¥–ª—è ML/–∞–Ω–∞–ª–∏–∑–∞ –∫–∞—á–µ—Å—Ç–≤–∞ AI
```

**–í–æ–ø—Ä–æ—Å –¥–ª—è –æ–±—Å—É–∂–¥–µ–Ω–∏—è:**
- –ù—É–∂–Ω–∞ –ª–∏ –≤–∞–º –∏—Å—Ç–æ—Ä–∏—è AI –æ—Ç–≤–µ—Ç–æ–≤ –¥–ª—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∏/–æ–±—É—á–µ–Ω–∏—è –º–æ–¥–µ–ª–µ–π?
- –ï—Å–ª–∏ –î–ê ‚Üí –æ—Å—Ç–∞–≤–∏—Ç—å –Ω–∞–¥–æ–ª–≥–æ (180 –¥–Ω–µ–π) –∏–ª–∏ –∞—Ä—Ö–∏–≤–∏—Ä–æ–≤–∞—Ç—å
- –ï—Å–ª–∏ –ù–ï–¢ ‚Üí —É–¥–∞–ª—è—Ç—å —á–µ—Ä–µ–∑ 30 –¥–Ω–µ–π

---

### 6. cron.job_run_details (–õ–æ–≥–∏ CRON –∑–∞–¥–∞—á, ~59 MB)

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:**
- –í—Å—Ç—Ä–æ–µ–Ω–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ pg_cron
- –•—Ä–∞–Ω–∏—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –≤—Å–µ—Ö CRON –∑–∞–¥–∞—á

**–¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ:**
- ‚ùå –ê–≤—Ç–æ–æ—á–∏—Å—Ç–∫–∞ –ù–ï –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∞ (pg_cron –Ω–µ —á–∏—Å—Ç–∏—Ç —Å–∞–º)

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:**
```
‚úÖ –ù–ê–°–¢–†–û–ò–¢–¨ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫—É—é –æ—á–∏—Å—Ç–∫—É:
   - –ü–µ—Ä–∏–æ–¥ —Ö—Ä–∞–Ω–µ–Ω–∏—è: 7 –¥–Ω–µ–π
   - –†–∞—Å–ø–∏—Å–∞–Ω–∏–µ: –µ–∂–µ–¥–Ω–µ–≤–Ω–æ –≤ 06:00 UTC
   - –ë–∞—Ç—á-—Ä–∞–∑–º–µ—Ä: 10,000 –∑–∞–ø–∏—Å–µ–π –∑–∞ —Ä–∞–∑
```

**–û–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ:**
- CRON –∑–∞–¥–∞—á–∏ –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è —á–∞—Å—Ç–æ (–Ω–µ–∫–æ—Ç–æ—Ä—ã–µ –∫–∞–∂–¥—É—é –º–∏–Ω—É—Ç—É!)
- –ó–∞ –Ω–µ–¥–µ–ª—é –Ω–∞–∫–∞–ø–ª–∏–≤–∞–µ—Ç—Å—è ~10,000+ –∑–∞–ø–∏—Å–µ–π
- –°—Ç–∞—Ä—ã–µ –ª–æ–≥–∏ CRON –Ω–µ –Ω—É–∂–Ω—ã –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞

**SQL –¥–ª—è –æ—á–∏—Å—Ç–∫–∏:**
```sql
-- –£–¥–∞–ª—è—Ç—å –ª–æ–≥–∏ CRON —Å—Ç–∞—Ä—à–µ 7 –¥–Ω–µ–π
DELETE FROM cron.job_run_details
WHERE end_time < NOW() - INTERVAL '7 days';
```

---

### 7. consent_logs –∏ fallback_action_logs

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:**
- `consent_logs` - –ª–æ–≥–∏ —Å–æ–≥–ª–∞—Å–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (GDPR)
- `fallback_action_logs` - –ª–æ–≥–∏ fallback –¥–µ–π—Å—Ç–≤–∏–π

**–¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ:**
- ‚ùå –ê–≤—Ç–æ–æ—á–∏—Å—Ç–∫–∞ –ù–ï –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∞

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:**
```
‚ö†Ô∏è consent_logs - –ù–ï –£–î–ê–õ–Ø–¢–¨ –ë–ï–ó –Æ–†–ò–°–¢–ê!
   - –õ–æ–≥–∏ —Å–æ–≥–ª–∞—Å–∏–π –º–æ–≥—É—Ç —Ç—Ä–µ–±–æ–≤–∞—Ç—å—Å—è –ø–æ –∑–∞–∫–æ–Ω—É (GDPR)
   - –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–π –ø–µ—Ä–∏–æ–¥ —Ö—Ä–∞–Ω–µ–Ω–∏—è: 3-7 –ª–µ—Ç (–∑–∞–≤–∏—Å–∏—Ç –æ—Ç —é—Ä–∏—Å–¥–∏–∫—Ü–∏–∏)
   - –ü—Ä–æ–∫–æ–Ω—Å—É–ª—å—Ç–∏—Ä—É–π—Ç–µ—Å—å —Å —é—Ä–∏—Å—Ç–æ–º –ø–µ—Ä–µ–¥ –Ω–∞—Å—Ç—Ä–æ–π–∫–æ–π –æ—á–∏—Å—Ç–∫–∏

‚úÖ fallback_action_logs - –º–æ–∂–Ω–æ –æ—á–∏—â–∞—Ç—å:
   - –ü–µ—Ä–∏–æ–¥ —Ö—Ä–∞–Ω–µ–Ω–∏—è: 30 –¥–Ω–µ–π
   - –†–∞—Å–ø–∏—Å–∞–Ω–∏–µ: –µ–∂–µ–Ω–µ–¥–µ–ª—å–Ω–æ –≤ –≤–æ—Å–∫—Ä–µ—Å–µ–Ω—å–µ 07:00 UTC
```

---

### 8. replicas (~336 MB) - –¢–†–ï–ë–£–ï–¢ –£–¢–û–ß–ù–ï–ù–ò–Ø!

**‚ö†Ô∏è –í–ù–ò–ú–ê–ù–ò–ï:** –¢–∞–±–ª–∏—Ü–∞ `replicas` –∑–∞–Ω–∏–º–∞–µ—Ç 336 MB, –Ω–æ –Ω–µ–ø–æ–Ω—è—Ç–Ω–æ –µ—ë –Ω–∞–∑–Ω–∞—á–µ–Ω–∏–µ!

**–í–æ–ø—Ä–æ—Å—ã –¥–ª—è —É—Ç–æ—á–Ω–µ–Ω–∏—è:**
1. –ß—Ç–æ —ç—Ç–æ –∑–∞ —Ç–∞–±–ª–∏—Ü–∞? (–ø–æ–∏—Å–∫ –ø–æ –º–∏–≥—Ä–∞—Ü–∏—è–º –Ω–µ –¥–∞–ª —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤)
2. –≠—Ç–æ –ª–æ–≥–∏ —Ä–µ–ø–ª–∏–∫–∞—Ü–∏–∏ PostgreSQL?
3. –≠—Ç–æ —Ä–∞–±–æ—á–∏–µ –¥–∞–Ω–Ω—ã–µ –∏–ª–∏ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –ª–æ–≥–∏?

**–î–µ–π—Å—Ç–≤–∏—è:**
```
üîç –ü–†–û–í–ï–†–ò–¢–¨:
   - –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—É —Ç–∞–±–ª–∏—Ü—ã
   - –£–∑–Ω–∞—Ç—å –æ—Ç–∫—É–¥–∞ –¥–∞–Ω–Ω—ã–µ –ø–æ–ø–∞–¥–∞—é—Ç
   - –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å –Ω—É–∂–Ω—ã –ª–∏ —ç—Ç–∏ –¥–∞–Ω–Ω—ã–µ

–ü–æ—Å–ª–µ —É—Ç–æ—á–Ω–µ–Ω–∏—è - —Ä–µ—à–∏—Ç—å –Ω—É–∂–Ω–∞ –ª–∏ –æ—á–∏—Å—Ç–∫–∞
```

---

## üìã –ò–¢–û–ì–û–í–´–ô –ü–õ–ê–ù –î–ï–ô–°–¢–í–ò–ô

### –®–ê–ì 1: –ù–µ–º–µ–¥–ª–µ–Ω–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è (–°–ï–ô–ß–ê–°)

1. ‚úÖ **–î–æ–∂–¥–∞—Ç—å—Å—è –æ—á–∏—Å—Ç–∫–∏ audit_log** (—É–∂–µ –∏–¥—ë—Ç, –æ—Å—Ç–∞–ª–æ—Å—å 3-5 —á–∞—Å–æ–≤)
2. ‚ö†Ô∏è **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∞–∫—Ç—É–∞–ª—å–Ω–æ—Å—Ç—å CRON –∑–∞–¥–∞—á:**
   - `process-scheduled-replies` - –Ω—É–∂–Ω–∞ –ª–∏ —ç—Ç–∞ –∑–∞–¥–∞—á–∞?
   - `sync-ozon-marketplaces` - –¥—É–±–ª–∏—Ä—É–µ—Ç –ª–∏ `ozon-performance-daily-sync`?

### –®–ê–ì 2: –°–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏–µ —Å –≤–∞–º–∏ (–û–ë–°–£–î–ò–¢–¨)

**–í–æ–ø—Ä–æ—Å—ã –¥–ª—è —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏—è:**

1. **ai_reply_history** - –Ω—É–∂–Ω–∞ –ª–∏ –∏—Å—Ç–æ—Ä–∏—è AI –æ—Ç–≤–µ—Ç–æ–≤ –¥–ª—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∏?
   - [ ] –î–∞, —Ö—Ä–∞–Ω–∏—Ç—å 180 –¥–Ω–µ–π
   - [ ] –ù–µ—Ç, —É–¥–∞–ª—è—Ç—å —á–µ—Ä–µ–∑ 30 –¥–Ω–µ–π
   - [ ] –ê—Ä—Ö–∏–≤–∏—Ä–æ–≤–∞—Ç—å –æ—Ç–¥–µ–ª—å–Ω–æ

2. **consent_logs** - –ø—Ä–æ–∫–æ–Ω—Å—É–ª—å—Ç–∏—Ä–æ–≤–∞–ª–∏—Å—å —Å —é—Ä–∏—Å—Ç–æ–º?
   - [ ] –î–∞, –º–æ–∂–Ω–æ —É–¥–∞–ª—è—Ç—å —á–µ—Ä–µ–∑ _____ –¥–Ω–µ–π
   - [ ] –ù–µ—Ç, –Ω–µ —É–¥–∞–ª—è—Ç—å –¥–æ –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏–∏

3. **replicas** - —á—Ç–æ —ç—Ç–æ –∑–∞ —Ç–∞–±–ª–∏—Ü–∞?
   - [ ] –ù—É–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å
   - [ ] –≠—Ç–æ –ª–æ–≥–∏, –º–æ–∂–Ω–æ –æ—á–∏—â–∞—Ç—å
   - [ ] –≠—Ç–æ —Ä–∞–±–æ—á–∏–µ –¥–∞–Ω–Ω—ã–µ, –ù–ï —Ç—Ä–æ–≥–∞—Ç—å

4. **–ü–µ—Ä–∏–æ–¥ —Ö—Ä–∞–Ω–µ–Ω–∏—è –ª–æ–≥–æ–≤** - —Å–æ–≥–ª–∞—Å–Ω—ã —Å –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–Ω—ã–º–∏ —Å—Ä–æ–∫–∞–º–∏?
   - audit_log: 7 –¥–Ω–µ–π ‚úÖ
   - ozon_sync_history: 30 –¥–Ω–µ–π ?
   - import_logs: 90 –¥–Ω–µ–π ?
   - logs_ai: 14 –¥–Ω–µ–π ?
   - cron.job_run_details: 7 –¥–Ω–µ–π ?
   - fallback_action_logs: 30 –¥–Ω–µ–π ?

### –®–ê–ì 3: –†–µ–∞–ª–∏–∑–∞—Ü–∏—è (–ü–û–°–õ–ï –°–û–ì–õ–ê–°–û–í–ê–ù–ò–Ø)

–ü–æ—Å–ª–µ –≤–∞—à–µ–≥–æ –æ–¥–æ–±—Ä–µ–Ω–∏—è —è —Å–æ–∑–¥–∞–º:

1. **SQL –º–∏–≥—Ä–∞—Ü–∏–∏** –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –æ—á–∏—Å—Ç–∫–∏ –∫–∞–∂–¥–æ–π —Ç–∞–±–ª–∏—Ü—ã
2. **CRON –∑–∞–¥–∞—á–∏** –¥–ª—è —Ä–µ–≥—É–ª—è—Ä–Ω–æ–π –æ—á–∏—Å—Ç–∫–∏
3. **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é** –ø–æ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥—É –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—é –æ—á–∏—Å—Ç–∫–æ–π
4. **–°–∫—Ä–∏–ø—Ç—ã** –¥–ª—è –æ–¥–Ω–æ—Ä–∞–∑–æ–≤–æ–π –æ—á–∏—Å—Ç–∫–∏ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –ª–æ–≥–æ–≤ (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)

---

## üîß –î–û–ü–û–õ–ù–ò–¢–ï–õ–¨–ù–´–ï –†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–ò

### 1. –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Ä–∞–∑–º–µ—Ä–∞ –ë–î

–°–æ–∑–¥–∞—Ç—å –¥–∞—à–±–æ—Ä–¥ –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è:
- –†–∞–∑–º–µ—Ä –∫–∞–∂–¥–æ–π —Ç–∞–±–ª–∏—Ü—ã —Å –ª–æ–≥–∞–º–∏
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø–∏—Å–µ–π –≤ –ª–æ–≥–∞—Ö
- –ß–∞—Å—Ç–æ—Ç–∞ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏—è CRON –æ—á–∏—Å—Ç–∫–∏

### 2. –ò–Ω–¥–µ–∫—Å—ã –¥–ª—è –æ—á–∏—Å—Ç–∫–∏

–£–±–µ–¥–∏—Ç—å—Å—è —á—Ç–æ –µ—Å—Ç—å –∏–Ω–¥–µ–∫—Å—ã –ø–æ `created_at` –¥–ª—è –≤—Å–µ—Ö —Ç–∞–±–ª–∏—Ü —Å –ª–æ–≥–∞–º–∏:
```sql
-- –ü—Ä–∏–º–µ—Ä
CREATE INDEX IF NOT EXISTS idx_logs_ai_created_at
ON public.logs_ai(created_at);
```

### 3. VACUUM –ø–æ—Å–ª–µ –æ—á–∏—Å—Ç–∫–∏

–ü–æ—Å–ª–µ –º–∞—Å—Å–æ–≤–æ–π –æ—á–∏—Å—Ç–∫–∏ –∑–∞–ø—É—Å–∫–∞—Ç—å VACUUM:
```sql
VACUUM ANALYZE public.audit_log;
VACUUM ANALYZE public.logs_ai;
-- –∏ —Ç.–¥.
```

### 4. –ê—Ä—Ö–∏–≤–∏—Ä–æ–≤–∞–Ω–∏–µ –≤–º–µ—Å—Ç–æ —É–¥–∞–ª–µ–Ω–∏—è

–î–ª—è –≤–∞–∂–Ω—ã—Ö –ª–æ–≥–æ–≤ (consent_logs, import_logs) –º–æ–∂–Ω–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å:
- –ü–µ—Ä–µ–Ω–æ—Å —Å—Ç–∞—Ä—ã—Ö –¥–∞–Ω–Ω—ã—Ö –≤ –∞—Ä—Ö–∏–≤–Ω—É—é —Ç–∞–±–ª–∏—Ü—É
- –≠–∫—Å–ø–æ—Ä—Ç –≤ S3/–≤–Ω–µ—à–Ω–µ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ
- –°–∂–∞—Ç–∏–µ –∞—Ä—Ö–∏–≤–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö

---

## ‚ùì –í–û–ü–†–û–°–´ –î–õ–Ø –í–ê–°

–ü–µ—Ä–µ–¥ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–æ–π –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –æ—á–∏—Å—Ç–∫–∏ –º–Ω–µ –Ω—É–∂–Ω–æ –æ—Ç –≤–∞—Å:

1. ‚úÖ **–°–æ–≥–ª–∞—Å–æ–≤–∞—Ç—å –ø–µ—Ä–∏–æ–¥—ã —Ö—Ä–∞–Ω–µ–Ω–∏—è** –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ç–∏–ø–∞ –ª–æ–≥–æ–≤ (—Å–º. –®–ê–ì 2)
2. ‚úÖ **–£—Ç–æ—á–Ω–∏—Ç—å –Ω–∞–∑–Ω–∞—á–µ–Ω–∏–µ —Ç–∞–±–ª–∏—Ü—ã** `replicas` (336 MB)
3. ‚úÖ **–†–µ—à–∏—Ç—å —Å—É–¥—å–±—É** `ai_reply_history` (—Ö—Ä–∞–Ω–∏—Ç—å/—É–¥–∞–ª—è—Ç—å/–∞—Ä—Ö–∏–≤–∏—Ä–æ–≤–∞—Ç—å)
4. ‚úÖ **–ü—Ä–æ–∫–æ–Ω—Å—É–ª—å—Ç–∏—Ä–æ–≤–∞—Ç—å—Å—è —Å —é—Ä–∏—Å—Ç–æ–º** –ø–æ `consent_logs`
5. ‚úÖ **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∞–∫—Ç—É–∞–ª—å–Ω–æ—Å—Ç—å** —Å—Ç–∞—Ä—ã—Ö CRON –∑–∞–¥–∞—á

**–ö–æ–≥–¥–∞ –≤—ã –æ—Ç–≤–µ—Ç–∏—Ç–µ –Ω–∞ —ç—Ç–∏ –≤–æ–ø—Ä–æ—Å—ã, —è —Ä–∞–∑—Ä–∞–±–æ—Ç–∞—é –∏ –≤–Ω–µ–¥—Ä—é —Å–∏—Å—Ç–µ–º—É –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –æ—á–∏—Å—Ç–∫–∏ –ª–æ–≥–æ–≤!**

---

**–ü–æ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω–æ:** Claude Code
**–î–∞—Ç–∞:** 2026-01-25
**–í–µ—Ä—Å–∏—è:** 1.0
