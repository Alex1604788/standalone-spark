# üîç –ü—Ä–æ–±–ª–µ–º–∞ –∏ —Ä–µ—à–µ–Ω–∏–µ

## –ß—Ç–æ –≤–∏–¥–Ω–æ –∏–∑ –ª–æ–≥–æ–≤:

1. ‚úÖ **–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ:**
   - `use_templates_X = true` –¥–ª—è –≤—Å–µ—Ö —Ä–µ–π—Ç–∏–Ω–≥–æ–≤
   - –†–µ–∂–∏–º—ã: 1-3 –∑–≤–µ–∑–¥—ã = `semi`, 4-5 –∑–≤–µ–∑–¥ = `auto`

2. ‚ùå **–ü—Ä–æ–±–ª–µ–º–∞:**
   - –í –ª–æ–≥–∞—Ö –≤–∏–¥–Ω–æ: `"Skip review ...: reply exists"`
   - –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ **2 –æ—Ç–∑—ã–≤–∞** –≤–º–µ—Å—Ç–æ 200
   - –≠—Ç–æ –∑–Ω–∞—á–∏—Ç, —á—Ç–æ **—Å—Ç–∞—Ä–∞—è –≤–µ—Ä—Å–∏—è —Ñ—É–Ω–∫—Ü–∏–∏ –≤—Å–µ –µ—â–µ —Ä–∞–±–æ—Ç–∞–µ—Ç**

## –†–µ—à–µ–Ω–∏–µ:

### –í–∞—Ä–∏–∞–Ω—Ç 1: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, –∑–∞–¥–µ–ø–ª–æ–∏–ª–∞—Å—å –ª–∏ –Ω–æ–≤–∞—è –≤–µ—Ä—Å–∏—è

1. –û—Ç–∫—Ä–æ–π—Ç–µ Supabase Dashboard ‚Üí Edge Functions ‚Üí auto-generate-drafts ‚Üí **Code**
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–¥ —Ñ—É–Ω–∫—Ü–∏–∏ - –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å —Å—Ç—Ä–æ–∫–∞:
   ```typescript
   // ‚úÖ –£–ë–ò–†–ê–ï–ú –ø—Ä–æ–≤–µ—Ä–∫—É –Ω–∞ existingReply
   ```
   –ò –ù–ï –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å:
   ```typescript
   if (existingReply && existingReply.length > 0) {
     console.log(`[auto-generate-drafts] Skip review ${review.id}: reply exists`);
     continue;
   }
   ```

### –í–∞—Ä–∏–∞–Ω—Ç 2: –ü–µ—Ä–µ–∑–∞–¥–µ–ø–ª–æ–∏—Ç—å —Ñ—É–Ω–∫—Ü–∏—é

–ï—Å–ª–∏ —Å—Ç–∞—Ä–∞—è –≤–µ—Ä—Å–∏—è –≤—Å–µ –µ—â–µ —Ä–∞–±–æ—Ç–∞–µ—Ç:

1. –û—Ç–∫—Ä–æ–π—Ç–µ —Ñ–∞–π–ª `supabase/functions/auto-generate-drafts/index.ts` –≤ VS Code
2. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ –í–ï–°–¨ –∫–æ–¥ (Ctrl+A, Ctrl+C)
3. Supabase Dashboard ‚Üí Edge Functions ‚Üí auto-generate-drafts ‚Üí **Code**
4. –í—Å—Ç–∞–≤—å—Ç–µ –∫–æ–¥ (Ctrl+V)
5. –ù–∞–∂–º–∏—Ç–µ **Deploy**

### –í–∞—Ä–∏–∞–Ω—Ç 3: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, –ø–æ—á–µ–º—É —Ç–∞–∫ –º–∞–ª–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è

–í—ã–ø–æ–ª–Ω–∏—Ç–µ SQL:
```sql
-- –°–∫–æ–ª—å–∫–æ –æ—Ç–∑—ã–≤–æ–≤ –≤ —Å—Ç–∞—Ç—É—Å–µ 'unanswered' –¥–ª—è —Ä–µ–∂–∏–º–æ–≤ 'auto' –∏ 'semi'
SELECT 
  rev.rating,
  CASE rev.rating
    WHEN 1 THEN ms.reviews_mode_1
    WHEN 2 THEN ms.reviews_mode_2
    WHEN 3 THEN ms.reviews_mode_3
    WHEN 4 THEN ms.reviews_mode_4
    WHEN 5 THEN ms.reviews_mode_5
  END as mode,
  COUNT(*) as count
FROM reviews rev
CROSS JOIN marketplace_settings ms
WHERE rev.segment = 'unanswered'
  AND rev.deleted_at IS NULL
  AND CASE rev.rating
    WHEN 1 THEN ms.reviews_mode_1
    WHEN 2 THEN ms.reviews_mode_2
    WHEN 3 THEN ms.reviews_mode_3
    WHEN 4 THEN ms.reviews_mode_4
    WHEN 5 THEN ms.reviews_mode_5
  END IN ('auto', 'semi')
GROUP BY rev.rating, mode
ORDER BY rev.rating;
```

## –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç –ø–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:

- ‚úÖ –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è –¥–æ **200 –æ—Ç–∑—ã–≤–æ–≤** –∑–∞ –∑–∞–ø—É—Å–∫
- ‚úÖ –ù–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–π "Skip review ...: reply exists"
- ‚úÖ –®–∞–±–ª–æ–Ω—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –º–≥–Ω–æ–≤–µ–Ω–Ω–æ
- ‚úÖ –ó–∞ 5 –º–∏–Ω—É—Ç –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è **200+ –æ—Ç–∑—ã–≤–æ–≤** (–≤–º–µ—Å—Ç–æ 2)



