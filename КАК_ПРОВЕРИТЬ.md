# ✅ Как проверить, что функция работает

## Способ 1: Проверить логи в Supabase Dashboard

1. Откройте https://supabase.com/dashboard
2. Выберите ваш проект
3. Перейдите в **Edge Functions** → **auto-generate-drafts**
4. Откройте вкладку **Logs**
5. Проверьте последние записи - должны быть строки типа:
   ```
   [auto-generate-drafts] Starting for user ...
   [auto-generate-drafts] Found X unanswered reviews
   [auto-generate-drafts] Completed: Reviews - X drafts, Y scheduled
   ```

## Способ 2: Проверить через SQL (РЕКОМЕНДУЕТСЯ)

1. Откройте Supabase Dashboard → **SQL Editor**
2. Выполните SQL из файла `ПРОВЕРКА_РАБОТЫ.sql`
3. Проверьте результаты:
   - **Запрос 1**: Покажет последние созданные ответы (должны быть записи за последние 30 минут)
   - **Запрос 2**: Покажет статистику по статусам
   - **Запрос 3**: Покажет, сколько отзывов обработано за час

## Способ 3: Проверить в приложении

1. Откройте раздел **"Ожидают публикации"**
2. Должно увеличиваться количество отзывов
3. Откройте раздел **"Не отвечено"**
4. Должно уменьшаться количество отзывов

## Что должно происходить:

✅ **Каждые 5 минут** cron job запускает функцию
✅ **До 200 отзывов** обрабатываются за раз
✅ **Шаблоны** используются мгновенно (если включены)
✅ **ИИ-генерация** занимает время (если шаблоны выключены)

## Если не работает:

1. Проверьте логи функции (см. Способ 1)
2. Проверьте, что cron job настроен (выполните `SELECT * FROM cron.job WHERE jobname = 'auto-generate-drafts-cron';`)
3. Проверьте настройки маркетплейса (режимы должны быть "auto" или "semi")
4. Проверьте, что шаблоны созданы (если используете шаблоны)

