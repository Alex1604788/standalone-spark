# üìä –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö Supabase

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### –ó–∞–ø—É—Å—Ç–∏—Ç–µ SQL —Ñ–∞–π–ª—ã –≤ —Ç–∞–∫–æ–º –ø–æ—Ä—è–¥–∫–µ:

1. **QUICK_SIZE_CHECK.sql** ‚≠ê (–ù–ê–ß–ù–ò–¢–ï –° –≠–¢–û–ì–û!)
2. **TABLE_ROW_COUNTS.sql**
3. **CHECK_DUPLICATES.sql**
4. **CHECK_OLD_DATA.sql**
5. **CHECK_DEAD_TUPLES.sql**

---

## üìÅ –û–ø–∏—Å–∞–Ω–∏–µ —Ñ–∞–π–ª–æ–≤

### ‚ö° –ë—ã—Å—Ç—Ä—ã–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ (–≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è –∑–∞ —Å–µ–∫—É–Ω–¥—ã)

#### `QUICK_SIZE_CHECK.sql` ‚≠ê
**–í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è:** ~10 —Å–µ–∫—É–Ω–¥
**–ß—Ç–æ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç:**
- –û–±—â–∏–π —Ä–∞–∑–º–µ—Ä –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
- –¢–û–ü-10 —Å–∞–º—ã—Ö –±–æ–ª—å—à–∏—Ö —Ç–∞–±–ª–∏—Ü (–¥–∞–Ω–Ω—ã–µ + –∏–Ω–¥–µ–∫—Å—ã)
- –¢–û–ü-5 —Å–∞–º—ã—Ö –±–æ–ª—å—à–∏—Ö –∏–Ω–¥–µ–∫—Å–æ–≤

**–ó–∞—á–µ–º –Ω—É–∂–Ω–æ:** –ü–µ—Ä–≤–∏—á–Ω–∞—è –æ—Ü–µ–Ω–∫–∞ –ø—Ä–æ–±–ª–µ–º —Å —Ä–∞–∑–º–µ—Ä–æ–º –ë–î

---

#### `TABLE_ROW_COUNTS.sql`
**–í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è:** ~5 —Å–µ–∫—É–Ω–¥
**–ß—Ç–æ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç:**
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø–∏—Å–µ–π –≤–æ –≤—Å–µ—Ö —Ç–∞–±–ª–∏—Ü–∞—Ö
- –†–∞–∑–º–µ—Ä –∫–∞–∂–¥–æ–π —Ç–∞–±–ª–∏—Ü—ã

**–ó–∞—á–µ–º –Ω—É–∂–Ω–æ:** –ù–∞–π—Ç–∏ —Ç–∞–±–ª–∏—Ü—ã —Å –∞–Ω–æ–º–∞–ª—å–Ω–æ –±–æ–ª—å—à–∏–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º –∑–∞–ø–∏—Å–µ–π

---

#### `CHECK_DEAD_TUPLES.sql`
**–í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è:** ~5 —Å–µ–∫—É–Ω–¥
**–ß—Ç–æ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç:**
- –ú–µ—Ä—Ç–≤—ã–µ –∑–∞–ø–∏—Å–∏ (dead tuples) –≤ —Ç–∞–±–ª–∏—Ü–∞—Ö
- –ü—Ä–æ—Ü–µ–Ω—Ç –º–µ—Ä—Ç–≤—ã—Ö –∑–∞–ø–∏—Å–µ–π
- –ö–æ–≥–¥–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–π —Ä–∞–∑ –±—ã–ª VACUUM
- –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –Ω—É–∂–µ–Ω –ª–∏ VACUUM

**–ó–∞—á–µ–º –Ω—É–∂–Ω–æ:** –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å –Ω—É–∂–Ω–∞ –ª–∏ –æ—á–∏—Å—Ç–∫–∞ –±–∞–∑—ã (VACUUM)

---

### üêå –ú–µ–¥–ª–µ–Ω–Ω—ã–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ (–º–æ–≥—É—Ç –∑–∞–Ω—è—Ç—å –≤—Ä–µ–º—è)

#### `CHECK_DUPLICATES.sql`
**–í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è:** ~30 —Å–µ–∫—É–Ω–¥
**–ß—Ç–æ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç:**
- –î—É–±–ª–∏–∫–∞—Ç—ã –≤ reviews
- –î—É–±–ª–∏–∫–∞—Ç—ã –≤ products
- –î—É–±–ª–∏–∫–∞—Ç—ã –≤ ozon_performance_daily
- –î—É–±–ª–∏–∫–∞—Ç—ã –≤ replies

**–ó–∞—á–µ–º –Ω—É–∂–Ω–æ:** –ù–∞–π—Ç–∏ –∏ —É–¥–∞–ª–∏—Ç—å –¥—É–±–ª–∏–∫–∞—Ç—ã –¥–∞–Ω–Ω—ã—Ö

---

#### `CHECK_OLD_DATA.sql`
**–í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è:** ~20 —Å–µ–∫—É–Ω–¥
**–ß—Ç–æ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç:**
- –°—Ç–∞—Ä—ã–µ –ª–æ–≥–∏ AI (>90 –¥–Ω–µ–π)
- –°—Ç–∞—Ä—ã–µ ai_reply_history (>90 –¥–Ω–µ–π)
- –°—Ç–∞—Ä—ã–µ audit_log (>180 –¥–Ω–µ–π)
- –°—Ç–∞—Ä—ã–µ import_logs (>90 –¥–Ω–µ–π)
- –°—Ç–∞—Ä—ã–µ ozon_sync_history (>90 –¥–Ω–µ–π)

**–ó–∞—á–µ–º –Ω—É–∂–Ω–æ:** –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å –∫–∞–∫–∏–µ –¥–∞–Ω–Ω—ã–µ –º–æ–∂–Ω–æ –∞—Ä—Ö–∏–≤–∏—Ä–æ–≤–∞—Ç—å/—É–¥–∞–ª–∏—Ç—å

---

### üî¥ –ù–µ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å

#### `DATABASE_SIZE_DIAGNOSTIC.sql`
**–°—Ç–∞—Ç—É—Å:** ‚ö†Ô∏è **–°–õ–ò–®–ö–û–ú –¢–Ø–ñ–ï–õ–´–ô - –ü–ê–î–ê–ï–¢ –° –¢–ê–ô–ú–ê–£–¢–û–ú**
**–ü—Ä–æ–±–ª–µ–º–∞:** –í—ã–ø–æ–ª–Ω—è–µ—Ç —Å–ª–∏—à–∫–æ–º –º–Ω–æ–≥–æ —Ç—è–∂–µ–ª—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ –ø–æ–¥—Ä—è–¥

**–†–µ—à–µ–Ω–∏–µ:** –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ª–µ–≥–∫–∏–µ —Ñ–∞–π–ª—ã –≤—ã—à–µ –ø–æ –æ—Ç–¥–µ–ª—å–Ω–æ—Å—Ç–∏

---

## üìñ –ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å

### –°–ø–æ—Å–æ–± 1: –ß–µ—Ä–µ–∑ Supabase Dashboard (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

1. –û—Ç–∫—Ä–æ–π—Ç–µ SQL Editor:
   ```
   https://supabase.com/dashboard/project/bkmicyguzlwampuindff/sql/new
   ```

2. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –Ω—É–∂–Ω–æ–≥–æ SQL —Ñ–∞–π–ª–∞

3. –í—Å—Ç–∞–≤—å—Ç–µ –≤ —Ä–µ–¥–∞–∫—Ç–æ—Ä –∏ –Ω–∞–∂–º–∏—Ç–µ **RUN**

4. –ò–∑—É—á–∏—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã

5. –ü–µ—Ä–µ—Ö–æ–¥–∏—Ç–µ –∫ —Å–ª–µ–¥—É—é—â–µ–º—É —Ñ–∞–π–ª—É

---

### –°–ø–æ—Å–æ–± 2: –ß–µ—Ä–µ–∑ psql (–µ—Å–ª–∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω)

```bash
psql "postgresql://postgres.bkmicyguzlwampuindff:PASSWORD@aws-0-eu-central-1.pooler.supabase.com:6543/postgres" -f QUICK_SIZE_CHECK.sql
```

---

## üéØ –ß—Ç–æ –∏—Å–∫–∞—Ç—å –≤ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞—Ö

### –ü–æ—Å–ª–µ QUICK_SIZE_CHECK.sql:
- ‚úÖ –†–∞–∑–º–µ—Ä –ë–î < 500MB - –≤—Å—ë –≤ –ø–æ—Ä—è–¥–∫–µ
- ‚ö†Ô∏è –†–∞–∑–º–µ—Ä –ë–î 500MB - 2GB - —Å—Ç–æ–∏—Ç –ø–æ—á–∏—Å—Ç–∏—Ç—å
- üî¥ –†–∞–∑–º–µ—Ä –ë–î > 2GB - —Å—Ä–æ—á–Ω–æ –Ω—É–∂–Ω–∞ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è

### –ü–æ—Å–ª–µ TABLE_ROW_COUNTS.sql:
- –ù–∞–π–¥–∏—Ç–µ —Ç–∞–±–ª–∏—Ü—ã —Å –º–∏–ª–ª–∏–æ–Ω–∞–º–∏ –∑–∞–ø–∏—Å–µ–π
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω—É–∂–Ω—ã –ª–∏ –≤—Å–µ —ç—Ç–∏ –¥–∞–Ω–Ω—ã–µ

### –ü–æ—Å–ª–µ CHECK_DUPLICATES.sql:
- –ï—Å–ª–∏ duplicates > 0 - —É–¥–∞–ª–∏—Ç–µ –¥—É–±–ª–∏–∫–∞—Ç—ã
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ –∏–Ω–¥–µ–∫—Å—ã

### –ü–æ—Å–ª–µ CHECK_OLD_DATA.sql:
- –ï—Å–ª–∏ old_records > 10000 - –∞—Ä—Ö–∏–≤–∏—Ä—É–π—Ç–µ/—É–¥–∞–ª–∏—Ç–µ
- –û—Å–æ–±–µ–Ω–Ω–æ –≤–∞–∂–Ω–æ –¥–ª—è –ª–æ–≥–æ–≤

### –ü–æ—Å–ª–µ CHECK_DEAD_TUPLES.sql:
- –ï—Å–ª–∏ dead_tuple_percent > 20% - –Ω—É–∂–µ–Ω VACUUM
- –ï—Å–ª–∏ dead_tuples > 50000 - —Å—Ä–æ—á–Ω–æ –Ω—É–∂–µ–Ω VACUUM

---

## üí° –î–µ–π—Å—Ç–≤–∏—è –ø–æ—Å–ª–µ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏

### 1. –ï—Å–ª–∏ –Ω—É–∂–µ–Ω VACUUM:
```sql
VACUUM ANALYZE;
```

### 2. –ï—Å–ª–∏ –º–Ω–æ–≥–æ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤:
```sql
-- –°–æ–∑–¥–∞–π—Ç–µ —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ –∏–Ω–¥–µ–∫—Å—ã –∏–ª–∏ —É–¥–∞–ª–∏—Ç–µ –¥—É–±–ª–∏–∫–∞—Ç—ã
```

### 3. –ï—Å–ª–∏ –º–Ω–æ–≥–æ —Å—Ç–∞—Ä—ã—Ö –ª–æ–≥–æ–≤:
```sql
-- –£–¥–∞–ª–∏—Ç–µ —Å—Ç–∞—Ä—ã–µ –¥–∞–Ω–Ω—ã–µ
DELETE FROM logs_ai WHERE created_at < NOW() - INTERVAL '90 days';
VACUUM ANALYZE logs_ai;
```

### 4. –ï—Å–ª–∏ —Ç–∞–±–ª–∏—Ü–∞ —Å–ª–∏—à–∫–æ–º –±–æ–ª—å—à–∞—è:
- –ü–∞—Ä—Ç–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ
- –ê—Ä—Ö–∏–≤–∞—Ü–∏—è —Å—Ç–∞—Ä—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- –°–∂–∞—Ç–∏–µ TOAST –¥–∞–Ω–Ω—ã—Ö

---

## üìû –ü–æ–º–æ—â—å

–ï—Å–ª–∏ –Ω—É–∂–Ω–∞ –ø–æ–º–æ—â—å - —Å–º–æ—Ç—Ä–∏—Ç–µ —Ñ–∞–π–ª `–ò–ù–°–¢–†–£–ö–¶–ò–Ø_–î–ò–ê–ì–ù–û–°–¢–ò–ö–ò.md`
