# ‚úÖ –ß–¢–û –î–ï–õ–ê–¢–¨ –î–ê–õ–¨–®–ï

## –í—ã –ø—Ä–∞–≤—ã - –¥–∞–Ω–Ω—ã–µ –£–ñ–ï –ï–°–¢–¨ –≤ –±–∞–∑–µ!

–Ø –≤–∏–¥–µ–ª –æ—à–∏–±–∫–∏ –∏–∑-–∑–∞ –ø—Ä–æ–±–ª–µ–º —Å REST API, –Ω–æ –≤ Table Editor –≤—Å–µ –¥–∞–Ω–Ω—ã–µ –Ω–∞ –º–µ—Å—Ç–µ.

---

## üéØ –í–ê–®–ê –ó–ê–î–ê–ß–ê: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å—É–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ –æ—Ç—á–µ—Ç–∞—Ö

–í–∞–º –Ω—É–∂–Ω–æ —á—Ç–æ–±—ã:
- `orders + orders_model` = –∏—Ç–æ–≥–æ–≤—ã–µ –∑–∞–∫–∞–∑—ã
- `revenue + revenue_model` = –∏—Ç–æ–≥–æ–≤–∞—è –≤—ã—Ä—É—á–∫–∞

**–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤ –æ—Ç—á–µ—Ç–∞—Ö, –±–µ–∑ —Ä—É—á–Ω—ã—Ö SQL –∑–∞–ø—Ä–æ—Å–æ–≤ –∫–∞–∂–¥—ã–π —Ä–∞–∑!**

---

## üöÄ –†–ï–®–ï–ù–ò–ï: –°–æ–∑–¥–∞—Ç—å VIEW

–Ø —Å–æ–∑–¥–∞–ª SQL —Å–∫—Ä–∏–ø—Ç **`CREATE_VIEW_AUTO_SUM.sql`**

### –ß—Ç–æ –æ–Ω –¥–µ–ª–∞–µ—Ç:

–°–æ–∑–¥–∞–µ—Ç —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ (VIEW) `ozon_performance_summary`, –∫–æ—Ç–æ—Ä–æ–µ:

‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å—É–º–º–∏—Ä—É–µ—Ç `orders + orders_model` ‚Üí `total_orders`
‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å—É–º–º–∏—Ä—É–µ—Ç `revenue + revenue_model` ‚Üí `total_revenue`
‚úÖ –ü–µ—Ä–µ—Å—á–∏—Ç—ã–≤–∞–µ—Ç –≤—Å–µ –º–µ—Ç—Ä–∏–∫–∏ (ROI, –î–†–†, –∫–æ–Ω–≤–µ—Ä—Å–∏—è) —Å —É—á–µ—Ç–æ–º —ç—Ç–∏—Ö —Å—É–º–º

---

## üìã –ö–ê–ö –ü–†–ò–ú–ï–ù–ò–¢–¨:

### 1. –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–∫—Ä–∏–ø—Ç –≤ Supabase

1. –û—Ç–∫—Ä–æ–π—Ç–µ: https://supabase.com/dashboard/project/bkmicyguzlwampuindff/sql
2. –û—Ç–∫—Ä–æ–π—Ç–µ —Ñ–∞–π–ª `CREATE_VIEW_AUTO_SUM.sql`
3. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ –í–ï–°–¨ –∫–æ–¥
4. –í—Å—Ç–∞–≤—å—Ç–µ –≤ SQL Editor
5. –ù–∞–∂–º–∏—Ç–µ **RUN**

### 2. –ü–æ—Å–ª–µ —ç—Ç–æ–≥–æ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –Ω–æ–≤—ã–π VIEW

**–í–ú–ï–°–¢–û:**
```sql
SELECT * FROM ozon_performance_daily
```

**–ò–°–ü–û–õ–¨–ó–£–ô–¢–ï:**
```sql
SELECT * FROM ozon_performance_summary
```

---

## üí° –ü–†–ò–ú–ï–†–´ –ò–°–ü–û–õ–¨–ó–û–í–ê–ù–ò–Ø:

### –ü–æ–ª—É—á–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 7 –¥–Ω–µ–π (—Å –≥–æ—Ç–æ–≤—ã–º–∏ —Å—É–º–º–∞–º–∏):
```sql
SELECT
  stat_date,
  campaign_name,
  sku,
  total_orders,      -- ‚ú® –£–ñ–ï –°–£–ú–ú–ê orders + orders_model
  total_revenue,     -- ‚ú® –£–ñ–ï –°–£–ú–ú–ê revenue + revenue_model
  money_spent,
  roi,
  drr
FROM ozon_performance_summary
WHERE stat_date >= CURRENT_DATE - INTERVAL '7 days'
ORDER BY stat_date DESC;
```

### –ê–≥—Ä–µ–≥–∞—Ü–∏—è –ø–æ –¥–Ω—è–º:
```sql
SELECT
  stat_date,
  SUM(total_orders) as orders_total,
  SUM(total_revenue) as revenue_total,
  SUM(money_spent) as spent_total,
  ROUND(AVG(roi), 1) as avg_roi
FROM ozon_performance_summary
GROUP BY stat_date
ORDER BY stat_date DESC
LIMIT 30;
```

### –¢–æ–ø –∫–∞–º–ø–∞–Ω–∏–π –ø–æ –≤—ã—Ä—É—á–∫–µ:
```sql
SELECT
  campaign_name,
  SUM(total_orders) as orders,
  SUM(total_revenue) as revenue,
  SUM(money_spent) as spent,
  ROUND(AVG(roi), 1) as avg_roi
FROM ozon_performance_summary
WHERE stat_date >= CURRENT_DATE - INTERVAL '30 days'
GROUP BY campaign_name
ORDER BY revenue DESC
LIMIT 10;
```

---

## üîç –ü–†–û–í–ï–†–ö–ê –ß–¢–û –í–°–Å –†–ê–ë–û–¢–ê–ï–¢:

–ü–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è VIEW, –≤—ã–ø–æ–ª–Ω–∏—Ç–µ:

```sql
-- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ VIEW —Å–æ–∑–¥–∞–ª—Å—è
SELECT table_name
FROM information_schema.views
WHERE table_name = 'ozon_performance_summary';

-- –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –¥–∞–Ω–Ω—ã–µ
SELECT
  stat_date,
  orders,
  orders_model,
  total_orders,        -- –î–æ–ª–∂–Ω–∞ –±—ã—Ç—å —Å—É–º–º–∞ orders + orders_model
  revenue,
  revenue_model,
  total_revenue        -- –î–æ–ª–∂–Ω–∞ –±—ã—Ç—å —Å—É–º–º–∞ revenue + revenue_model
FROM ozon_performance_summary
WHERE orders_model > 0 OR revenue_model > 0
LIMIT 10;
```

---

## üìä –í –í–ê–®–ï–ú –ü–†–ò–õ–û–ñ–ï–ù–ò–ò:

–¢–µ–ø–µ—Ä—å –≤–æ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–µ –ø—Ä–æ—Å—Ç–æ –¥–µ–ª–∞–π—Ç–µ –∑–∞–ø—Ä–æ—Å—ã –∫ `ozon_performance_summary` –≤–º–µ—Å—Ç–æ `ozon_performance_daily`, –∏ –≤—Å–µ —Å—É–º–º—ã –±—É–¥—É—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:

```typescript
// –í –≤–∞—à–µ–º React –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–µ
const { data } = await supabase
  .from('ozon_performance_summary')  // ‚Üê –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ VIEW
  .select('*')
  .gte('stat_date', '2025-01-01')
  .order('stat_date', { ascending: false });

// data —É–∂–µ —Å–æ–¥–µ—Ä–∂–∏—Ç total_orders –∏ total_revenue!
```

---

## ‚úÖ –ò–¢–û–ì:

1. ‚úÖ –ó–∞–ø—É—Å—Ç–∏—Ç–µ `CREATE_VIEW_AUTO_SUM.sql` –≤ Supabase SQL Editor
2. ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `ozon_performance_summary` –≤–º–µ—Å—Ç–æ `ozon_performance_daily`
3. ‚úÖ –í—Å–µ —Å—É–º–º—ã –±—É–¥—É—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏!

**–ë–æ–ª—å—à–µ –Ω–µ –Ω—É–∂–Ω–æ —Ä—É–∫–∞–º–∏ —Å—É–º–º–∏—Ä–æ–≤–∞—Ç—å –≤ –∫–∞–∂–¥–æ–º –∑–∞–ø—Ä–æ—Å–µ!** üéâ

---

## üîß –î–û–ü–û–õ–ù–ò–¢–ï–õ–¨–ù–û:

–ï—Å–ª–∏ –Ω—É–∂–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞ 62 –¥–Ω—è:

```sql
SELECT
  MIN(stat_date) as first_date,
  MAX(stat_date) as last_date,
  MAX(stat_date) - MIN(stat_date) + 1 as days_count,
  COUNT(*) as records_count
FROM ozon_performance_summary;
```

–ï—Å–ª–∏ –¥–Ω–µ–π –º–µ–Ω—å—à–µ 62, –∑–∞–ø—É—Å—Ç–∏—Ç–µ `–ü–†–û–í–ï–†–ö–ê_–ò_–ó–ê–ü–£–°–ö_–ü–û–õ–ù–û–ô_–°–ò–ù–•–†–û–ù–ò–ó–ê–¶–ò–ò.sql`
