# üöÄ –ë–´–°–¢–†–´–ô –°–¢–ê–†–¢ - –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ OZON –∑–∞ 3 —à–∞–≥–∞

## –®–∞–≥ 1: –û—Ç–∫—Ä–æ–π—Ç–µ Supabase Dashboard

–ü–µ—Ä–µ–π–¥–∏—Ç–µ –ø–æ —Å—Å—ã–ª–∫–µ: https://supabase.com/dashboard/project/bkmicyguzlwampuindff/sql

## –®–∞–≥ 2: –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–∫—Ä–∏–ø—Ç –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

1. –û—Ç–∫—Ä–æ–π—Ç–µ —Ñ–∞–π–ª `–ó–ê–ü–£–°–ö_–ù–ê–°–¢–†–û–ô–ö–ò_OZON_SYNC.sql` –≤ —Ä–µ–¥–∞–∫—Ç–æ—Ä–µ
2. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ **–í–ï–°–¨** –∫–æ–¥ (Ctrl+A ‚Üí Ctrl+C)
3. –í—Å—Ç–∞–≤—å—Ç–µ –≤ SQL Editor –≤ Supabase (Ctrl+V)
4. –ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É **RUN** (–∏–ª–∏ F5)

## –®–∞–≥ 3: –î–æ–∂–¥–∏—Ç–µ—Å—å –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è

–í—ã —É–≤–∏–¥–∏—Ç–µ —Å–µ—Ä–∏—é —Å–æ–æ–±—â–µ–Ω–∏–π:
- ‚úÖ Service role key –Ω–∞—Å—Ç—Ä–æ–µ–Ω
- ‚úÖ –£–¥–∞–ª–µ–Ω—ã —Å—Ç–∞—Ä—ã–µ CRON jobs
- ‚úÖ –§—É–Ω–∫—Ü–∏—è —Å–æ–∑–¥–∞–Ω–∞
- ‚úÖ CRON jobs —Å–æ–∑–¥–∞–Ω—ã
- ‚úÖ –ú–∞—Ä–∫–µ—Ç–ø–ª–µ–π—Å –Ω–∞–π–¥–µ–Ω/—Å–æ–∑–¥–∞–Ω
- ‚úÖ API credentials –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã
- üöÄ –¢–µ—Å—Ç–æ–≤–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –∑–∞–ø—É—â–µ–Ω–∞

## ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

–ß–µ—Ä–µ–∑ 2-3 –º–∏–Ω—É—Ç—ã –≤—ã–ø–æ–ª–Ω–∏—Ç–µ –≤ SQL Editor:

```sql
-- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∏—Å—Ç–æ—Ä–∏—é —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–π
SELECT
  status,
  trigger_type,
  started_at,
  completed_at,
  campaigns_count,
  rows_inserted,
  metadata->>'version' as version
FROM ozon_sync_history
ORDER BY started_at DESC
LIMIT 10;

-- –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –¥–∞–Ω–Ω—ã–µ
SELECT
  stat_date,
  campaign_name,
  sku,
  money_spent,
  views,
  clicks,
  orders,
  revenue
FROM ozon_performance_daily
ORDER BY imported_at DESC
LIMIT 100;

-- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
SELECT
  m.name,
  mac.auto_sync_enabled,
  mac.is_active,
  mac.last_sync_at
FROM marketplace_api_credentials mac
JOIN marketplaces m ON m.id = mac.marketplace_id
WHERE mac.api_type = 'performance';
```

## üìÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è

–ü–æ—Å–ª–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –±—É–¥–µ—Ç –∑–∞–ø—É—Å–∫–∞—Ç—å—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:

- **–ï–∂–µ–¥–Ω–µ–≤–Ω–æ –≤ 03:00 UTC** (06:00 –ú–°–ö) - –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 7 –¥–Ω–µ–π
- **–ü–æ –≤–æ—Å–∫—Ä–µ—Å–µ–Ω—å—è–º –≤ 04:00 UTC** (07:00 –ú–°–ö) - –ø–æ–ª–Ω–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –∑–∞ 62 –¥–Ω—è

## üîß –†—É—á–Ω–æ–π –∑–∞–ø—É—Å–∫ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏

–ï—Å–ª–∏ –Ω—É–∂–Ω–æ –∑–∞–ø—É—Å—Ç–∏—Ç—å —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—é –≤—Ä—É—á–Ω—É—é:

```sql
-- –ó–∞–º–µ–Ω–∏—Ç—å YOUR_MARKETPLACE_ID –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã–π UUID –∏–∑ —Ç–∞–±–ª–∏—Ü—ã marketplaces
SELECT public.trigger_ozon_performance_sync(
  (SELECT id FROM marketplaces WHERE type = 'ozon' LIMIT 1),
  'daily'  -- –∏–ª–∏ 'full' –¥–ª—è –ø–æ–ª–Ω–æ–π —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏
);
```

## ‚ùì –ï—Å–ª–∏ —á—Ç–æ-—Ç–æ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç

1. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ Edge Function**:
   - Supabase Dashboard ‚Üí Edge Functions ‚Üí sync-ozon-performance ‚Üí Logs

2. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è PostgreSQL**:
   - Supabase Dashboard ‚Üí Database ‚Üí Extensions
   - –î–æ–ª–∂–Ω—ã –±—ã—Ç—å –≤–∫–ª—é—á–µ–Ω—ã: `pg_cron` –∏ `pg_net`

3. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –æ—à–∏–±–∫–∏ –≤ –∏—Å—Ç–æ—Ä–∏–∏**:
   ```sql
   SELECT * FROM ozon_sync_history
   WHERE status = 'failed'
   ORDER BY started_at DESC;
   ```

## üìû –í—Å—ë —Ä–∞–±–æ—Ç–∞–µ—Ç?

–ï—Å–ª–∏ –≤—Å—ë –Ω–∞—Å—Ç—Ä–æ–µ–Ω–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ, –≤—ã —É–≤–∏–¥–∏—Ç–µ:
- ‚úÖ –í `ozon_sync_history` –ø–æ—è–≤—è—Ç—Å—è –∑–∞–ø–∏—Å–∏ —Å–æ —Å—Ç–∞—Ç—É—Å–æ–º `completed`
- ‚úÖ –í `ozon_performance_daily` –ø–æ—è–≤—è—Ç—Å—è –¥–∞–Ω–Ω—ã–µ –ø–æ –∫–∞–º–ø–∞–Ω–∏—è–º
- ‚úÖ CRON jobs –±—É–¥—É—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –∫–∞–∂–¥—ã–π –¥–µ–Ω—å

---

**–ì–æ—Ç–æ–≤–æ!** üéâ –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è OZON Performance API –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∞ –∏ —Ä–∞–±–æ—Ç–∞–µ—Ç.
