-- =====================================================
-- –ü–†–ò–ú–ï–ù–ï–ù–ò–ï –í–°–ï–• –ú–ò–ì–†–ê–¶–ò–ô –î–õ–Ø –ê–í–¢–û–ú–ê–¢–ò–ß–ï–°–ö–û–ô –û–ß–ò–°–¢–ö–ò –õ–û–ì–û–í
-- =====================================================
-- –≠—Ç–æ—Ç —Å–∫—Ä–∏–ø—Ç –ø—Ä–∏–º–µ–Ω—è–µ—Ç –≤—Å–µ 7 –º–∏–≥—Ä–∞—Ü–∏–π –¥–ª—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
-- –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –æ—á–∏—Å—Ç–∫–∏ –ª–æ–≥–æ–≤ –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö.
--
-- –í—ã–ø–æ–ª–Ω–∏—Ç–µ —ç—Ç–æ—Ç —Å–∫—Ä–∏–ø—Ç –≤ Supabase SQL Editor:
-- 1. –û—Ç–∫—Ä–æ–π—Ç–µ Supabase Dashboard
-- 2. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ SQL Editor
-- 3. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ –∏ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ —ç—Ç–æ—Ç —Å–∫—Ä–∏–ø—Ç
-- =====================================================

\echo '========================================='
\echo '–ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –º–∏–≥—Ä–∞—Ü–∏–π –¥–ª—è –æ—á–∏—Å—Ç–∫–∏ –ª–æ–≥–æ–≤'
\echo '========================================='

-- =====================================================
-- –ú–ò–ì–†–ê–¶–ò–Ø 1: cleanup_ai_reply_history (30 –¥–Ω–µ–π)
-- =====================================================

\echo ''
\echo 'üì¶ –ú–∏–≥—Ä–∞—Ü–∏—è 1/7: cleanup_ai_reply_history...'

\i supabase/migrations/20260125120000_cleanup_ai_reply_history.sql

\echo '‚úÖ –ú–∏–≥—Ä–∞—Ü–∏—è 1/7 –ø—Ä–∏–º–µ–Ω–µ–Ω–∞'

-- =====================================================
-- –ú–ò–ì–†–ê–¶–ò–Ø 2: cleanup_logs_ai (7 –¥–Ω–µ–π)
-- =====================================================

\echo ''
\echo 'üì¶ –ú–∏–≥—Ä–∞—Ü–∏—è 2/7: cleanup_logs_ai...'

\i supabase/migrations/20260125120100_cleanup_logs_ai.sql

\echo '‚úÖ –ú–∏–≥—Ä–∞—Ü–∏—è 2/7 –ø—Ä–∏–º–µ–Ω–µ–Ω–∞'

-- =====================================================
-- –ú–ò–ì–†–ê–¶–ò–Ø 3: cleanup_import_logs (7 –¥–Ω–µ–π)
-- =====================================================

\echo ''
\echo 'üì¶ –ú–∏–≥—Ä–∞—Ü–∏—è 3/7: cleanup_import_logs...'

\i supabase/migrations/20260125120200_cleanup_import_logs.sql

\echo '‚úÖ –ú–∏–≥—Ä–∞—Ü–∏—è 3/7 –ø—Ä–∏–º–µ–Ω–µ–Ω–∞'

-- =====================================================
-- –ú–ò–ì–†–ê–¶–ò–Ø 4: cleanup_ozon_sync_history (30 –¥–Ω–µ–π)
-- =====================================================

\echo ''
\echo 'üì¶ –ú–∏–≥—Ä–∞—Ü–∏—è 4/7: cleanup_ozon_sync_history...'

\i supabase/migrations/20260125120300_cleanup_ozon_sync_history.sql

\echo '‚úÖ –ú–∏–≥—Ä–∞—Ü–∏—è 4/7 –ø—Ä–∏–º–µ–Ω–µ–Ω–∞'

-- =====================================================
-- –ú–ò–ì–†–ê–¶–ò–Ø 5: cleanup_cron_job_run_details (7 –¥–Ω–µ–π)
-- =====================================================

\echo ''
\echo 'üì¶ –ú–∏–≥—Ä–∞—Ü–∏—è 5/7: cleanup_cron_job_run_details...'

\i supabase/migrations/20260125120400_cleanup_cron_job_run_details.sql

\echo '‚úÖ –ú–∏–≥—Ä–∞—Ü–∏—è 5/7 –ø—Ä–∏–º–µ–Ω–µ–Ω–∞'

-- =====================================================
-- –ú–ò–ì–†–ê–¶–ò–Ø 6: cleanup_fallback_action_logs (7 –¥–Ω–µ–π)
-- =====================================================

\echo ''
\echo 'üì¶ –ú–∏–≥—Ä–∞—Ü–∏—è 6/7: cleanup_fallback_action_logs...'

\i supabase/migrations/20260125120500_cleanup_fallback_action_logs.sql

\echo '‚úÖ –ú–∏–≥—Ä–∞—Ü–∏—è 6/7 –ø—Ä–∏–º–µ–Ω–µ–Ω–∞'

-- =====================================================
-- –ú–ò–ì–†–ê–¶–ò–Ø 7: cleanup_consent_logs (–Ω–µ —Ö—Ä–∞–Ω–∏—Ç—å)
-- =====================================================

\echo ''
\echo 'üì¶ –ú–∏–≥—Ä–∞—Ü–∏—è 7/7: cleanup_consent_logs...'

\i supabase/migrations/20260125120600_cleanup_consent_logs.sql

\echo '‚úÖ –ú–∏–≥—Ä–∞—Ü–∏—è 7/7 –ø—Ä–∏–º–µ–Ω–µ–Ω–∞'

-- =====================================================
-- –ü–†–û–í–ï–†–ö–ê –†–ï–ó–£–õ–¨–¢–ê–¢–û–í
-- =====================================================

\echo ''
\echo '========================================='
\echo '–ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ–∑–¥–∞–Ω–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π –∏ CRON –∑–∞–¥–∞—á'
\echo '========================================='

-- –ü–æ–∫–∞–∑–∞—Ç—å —Å–æ–∑–¥–∞–Ω–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –æ—á–∏—Å—Ç–∫–∏
\echo ''
\echo 'üìã –°–æ–∑–¥–∞–Ω–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –æ—á–∏—Å—Ç–∫–∏:'
SELECT
  routine_name as "–§—É–Ω–∫—Ü–∏—è",
  routine_type as "–¢–∏–ø"
FROM information_schema.routines
WHERE routine_schema = 'public'
  AND routine_name LIKE 'cleanup_%'
ORDER BY routine_name;

-- –ü–æ–∫–∞–∑–∞—Ç—å —Å–æ–∑–¥–∞–Ω–Ω—ã–µ CRON –∑–∞–¥–∞—á–∏
\echo ''
\echo 'üìã –°–æ–∑–¥–∞–Ω–Ω—ã–µ CRON –∑–∞–¥–∞—á–∏:'
SELECT
  jobname as "–ù–∞–∑–≤–∞–Ω–∏–µ –∑–∞–¥–∞—á–∏",
  schedule as "–†–∞—Å–ø–∏—Å–∞–Ω–∏–µ",
  active as "–ê–∫—Ç–∏–≤–Ω–∞",
  jobid as "ID"
FROM cron.job
WHERE jobname LIKE 'cleanup-%'
ORDER BY jobname;

\echo ''
\echo '========================================='
\echo '‚úÖ –í–°–ï –ú–ò–ì–†–ê–¶–ò–ò –£–°–ü–ï–®–ù–û –ü–†–ò–ú–ï–ù–ï–ù–´!'
\echo '========================================='
